{"version":3,"sources":["../../src/link.ts","../../src/link-options.ts","assets/jungle.png","../../src/link-abi-data.ts","assets/eos.png","assets/fio.svg","assets/proton.png","assets/telos.png","assets/wax.png","../../src/errors.ts","../../src/utils.ts","../../src/index.ts","../../src/fuel.ts","../../src/styles.ts","Accounts.js","Blockchains.js","SigningError.js","Response.js","App.js","serviceWorker.js","index.js","../../src/link-session.ts"],"names":["t","key","this","sessionKey","identifier","formatAuth","module","exports","version","types","structs","name","base","fields","type","actions","ricardian_clauses","error_messages","tables","abi_extensions","reason","containerEl","infoEl","appendChild","Debug","props","chain","session","sessions","Table","Header","Row","HeaderCell","collapsing","length","Body","map","s","isCurrent","auth","actor","permission","Object","values","join","Cell","Button","color","content","disabled","onClick","setSession","icon","removeSession","textAlign","colSpan","Footer","fullWidth","basic","fluid","addAccount","primary","Component","logoMap","eosLogo","fioLogo","jungleLogo","protonLogo","telosLogo","waxLogo","options","blockchains","chainId","text","value","image","avatar","src","Blockchains","Dropdown","onChange","placeholder","search","selection","SigningError","error","console","log","Segment","size","message","transactionAbi","require","transactionTypes","Serialize","getTypesFromAbi","createInitialTypes","Transaction","testResponse","response","desc","test","r","signatures","data","JSON","stringify","transaction","serializedTransaction","tx","deserialize","expiration","ref_block_num","ref_block_prefix","e","testCase","res","val","serialized","buffer","SerialBuffer","array","get","tests","Fragment","style","overflowX","List","divided","relaxed","Item","Icon","verticalAlign","Content","Description","margin","background","dividing","borderBottom","language","showLineNumbers","theme","monokai","wrapLines","displayDataTypes","displayObjectSize","enableClipboard","iconStyle","payload","marginTop","overflow","signer","App","a","state","link","login","identity","listSessions","setState","undefined","establishLink","blockchain","find","rpc","rpcEndpoints","AnchorLink","protocol","host","port","service","transport","AnchorLinkBrowserTransport","enableGreymassFuel","requestStatus","restoreSession","signTransaction","action","account","authorization","producers","proxy","voter","transact","setChainId","searchParams","URLSearchParams","window","location","set","history","pushState","toString","filter","prevProps","prevState","Container","paddingTop","attached","block","Subheader","href","padded","Accounts","Response","Boolean","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","onSessionRequest"],"mappings":"+VAiGa,EAAb,WAgBI,WAAY,GACR,GAD4B,oBAJxB,cAAW,IAAI,IACf,iBAAc,IAAI,IAIC,kBAAZ,EACP,MAAM,IAAI,UAAU,0BAExB,IAAK,EAAQ,UACT,MAAM,IAAI,UACN,8FAGY,IAAhB,EAAQ,KAA4C,kBAAhB,EAAQ,IAC5C,KAAK,IAAM,IAAI,UAAQ,EAAQ,KAAO,IAAS,IAAK,CAAC,MAAO,MAE5D,KAAK,IAAM,EAAQ,IAEnB,EAAQ,QACR,KAAK,QAC0B,kBAApB,EAAQ,QACT,IAAa,EAAQ,SACrB,EAAQ,QAEZ,KAAD,QAAU,IAAS,QAExB,KAAC,gBAAkB,EAAQ,SAAW,IAAS,SAAS,OAAO,QAAQ,MAAO,IAC9E,KAAC,UAAY,EAAQ,UACD,OAApB,EAAQ,UACF,KAAD,QAAU,EAAQ,SAAW,KAAK,UAAU,SAEjD,KAAC,eAAiB,CAClB,YAAa,KACb,YAAa,EAAQ,aAAe,IAAI,YACxC,YAAa,EAAQ,aAAe,IAAI,YACxC,UA/CV,uBAAE,IAAJ,SAAI,MAAJ,WAAM,IAAN,mCAuDwB,GAvDhB,IAAR,IAAQ,OAAR,6DAwDY,EAAK,KAAK,SAAS,IAAI,GAxDnC,uBA0DgB,EAAS,KAAK,YAAY,IAAI,MAE9B,EAAS,KAAK,IAAI,QAAQ,GAC1B,KAAK,YAAY,IAAI,EAAS,IA7D9C,SA+DwB,EA/DxB,OA+DY,EA/DZ,OA+DgC,IACpB,KAAK,YAAY,OAAO,GACpB,GACA,KAAK,SAAS,IAAI,EAAS,GAlE3C,gCAqEe,GArEf,iDAAM,gBAAN,GAAQ,OAAR,8BAAI,IAAJ,oBAAI,MAAJ,WA6EQ,gBAAU,KAAK,eAAf,YAAiC,iBA7EzC,CAAI,IAAJ,gBAAI,MAAJ,WAAM,IAAN,mCAoF+B,EAAyC,GApFhE,IAAR,IAAQ,OAAR,0EAsF4B,IAAmB,OAAnB,eAET,EAFS,CAGZ,QAAS,KAAK,QACd,WAAW,EACX,SAAU,CACN,IAAK,KAAK,oBACV,YAAY,KAGpB,KAAK,gBAhGjB,UAsFY,EAtFZ,SAkGcA,EAAI,GAAa,KAAK,WACtB,QAnGd,gCAoG4B,EAAE,QAAQ,GApGtC,OAoGY,EApGZ,uCAsGe,GAtGf,gDAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,cAAI,MAAJ,WAAM,IAAN,mCA8GQ,EACA,GA/GA,IAAR,0CAAQ,OAAR,6DAgHQ,EAhHR,gCAkHc,EAAI,GAAa,KAAK,UAlHpC,UAoHkB,EAAU,EAAQ,KAAK,UAChB,WAAW,KAAK,gBArHzC,sBAsHsB,IAAI,MAAM,qCAtHhC,UAwHuC,IAAvB,EAAQ,KAAK,MAxH7B,sBAyHsB,IAAI,MAAM,yBAzHhC,cA6HkB,EAAS,EAAgB,EADzB,EAA6B,IAE7B,EAAS,IAAI,SAAe,SAAC,EAAS,GACxC,EAAE,UAAU,GAAS,SAAC,GACd,EAAI,QACJ,EAAI,SAGJ,EADkB,kBAAX,EACA,IAAI,IAAY,GAEhB,SAtI/B,UA0IkC,QAAQ,KAAK,CAAC,EAAQ,IA1IxD,eA0IkB,EA1IlB,OA2IkB,EAA0B,CAC5B,MAAO,EAAQ,GACf,WAAY,EAAQ,IAElB,EAAuB,OAAO,KAAK,GACpC,QAAO,SAAC,GAAD,OAAS,EAAI,WAAW,QAAkB,SAAR,KACzC,KAAI,SAAC,GAAD,OAAS,EAAQ,MAjJtC,UAmJmC,IAA2B,YAC9C,EACA,KAAK,gBArJrB,WAmJkB,EAnJlB,QAuJkB,EAAO,EAAS,QAAQ,WACtB,UACJ,EAAW,QAAQ,EAAI,UAEpB,EAAsC,EAAtC,sBAAuB,EAAe,EAAf,YACxB,EAAyB,CAC3B,QAAS,EAAS,QAClB,wBACA,cACA,aACA,UACA,WAEA,EApKhB,kCAqKkC,KAAK,IAAI,iBAAiB,CACxC,WAAY,EAAO,WACnB,sBAAuB,EAAO,wBAvKlD,QAqKsB,EArKtB,OAyKgB,EAAO,UAAY,EAAI,UAzKvC,eA2KgBA,EAAE,WACF,EAAE,UAAU,EAAS,GA5KrC,kBA8KmB,GA9KnB,wCAgLgB,EAAE,WACF,EAAE,UAAU,EAAZ,MAjLhB,+DAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,WAAI,MAAJ,WAAM,IAAN,mCAqMQ,EACA,EACA,GAvMA,IAAR,UAAQ,OAAR,iEAyMc,EAAI,GAAa,KAAK,UACtB,GAAY,IAAgC,IAAtB,EAAQ,UAEhC,EAAU,EAEV,EAAK,UACJ,EAAQ,YACL,EAAQ,eACR,EAAQ,kBACR,EAAQ,qBACR,EAAQ,kBACR,EAAQ,aAEZ,EAAO,CACH,YAAW,aACP,WAAY,sBACZ,cAAe,EACf,iBAAkB,EAClB,oBAAqB,EACrB,iBAAkB,EAClB,UAAW,GACR,KA9NvB,SAkO8B,KAAK,cAAc,EAAM,GAlOvD,cAkOc,EAlOd,gBAmO6B,KAAK,YAAY,EAAS,EAAG,GAnO1D,cAmOc,EAnOd,yBAoOe,GApOf,iDAAM,gBAAN,OAAQ,OAAR,8BAAI,IAAJ,WAAI,MAAJ,WAAM,IAAN,mCA8OQ,EACA,GA/OA,IAAR,kBAAQ,OAAR,0EAiP8B,KAAK,cAAc,CACrC,SAAU,CAAC,WAAY,GAAqB,MAC5C,SAnPZ,cAiPc,EAjPd,gBAqP0B,KAAK,YAAY,GArP3C,WAqPc,EArPd,QAsPiB,QAAQ,aAtPzB,sBAuPkB,IAAI,IAAJ,uBAvPlB,cAyPc,EAAU,EAAO,OAAO,CAC1B,EAAO,KAAK,EAAQ,aAAc,OAClC,EAAO,KAAK,EAAI,uBAChB,EAAO,MAAM,MAEV,EAAU,EAAV,OACD,EAAY,UAAY,EAAI,WAAW,GAAI,GA/PzD,UAgQ8B,KAAK,IAAI,YAAY,EAAO,OAhQ1D,WAgQc,EAhQd,8BAkQkB,IAAI,IAAJ,0CAAqD,EAAO,QAlQ9E,WAoQc,EAAa,EAAQ,YAAY,MACnC,qBAAE,YAA6B,EAAO,cArQlD,uBAwQkB,IAAI,IAAJ,UACC,EAAO,MADR,2CACgD,EAAO,aAzQzE,WA4Qc,EAAO,EAAW,cAClB,EAAU,EAAK,KAAK,MAAK,gBAAE,EAAF,EAAE,IAAF,OAAW,YAAe,EAAK,MA7QtE,uBA+QkB,IAAI,IAAJ,UAAqB,EAAW,GAAhC,sCA/QlB,aAiRY,EAAK,UAAY,EAAQ,QAjRrC,uBAkRkB,IAAI,IAAJ,UAAqB,EAAW,GAAhC,6CAlRlB,YAoRY,EApRZ,sBAsRiB,EAAkB,QAAU,KACzB,EAAkB,QAAU,EAAO,OACtC,EAAkB,aAAe,KAC9B,EAAkB,aAAe,EAAO,YAzR5D,uBA2RsB,IAAI,IAAJ,yCACgC,EAAW,GAD3C,sBACgE,EAC9D,GAFF,MA3RtB,gDAmSe,EAnSf,CAoSY,UACA,eArSZ,iDAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,QAAI,MAAJ,WAAM,IAAN,mCA8SuB,GA9Sf,IAAR,YAAQ,OAAR,0EA+SiC,cA/SjC,cA+Sc,EA/Sd,OAgTc,EAAa,kBAAoB,GACjC,EAAyB,CAC3B,aAAc,EACd,YAAa,GAnTzB,SAqT0B,KAAK,cAAS,EAAW,CACvC,KAAM,YAAU,EAAY,iBAtTxC,UAqTc,EArTd,OAwTc,EAAW,CAAC,gBAAwD,IAA5C,EAAI,QAAQ,aAAZ,aAG1B,EADA,EAAI,QAAQ,SAAW,EAAI,QAAQ,UAAY,EAAI,QAAQ,UACjD,IAAI,IACV,KACA,CACI,aACA,KAAM,EAAI,OACV,UAAW,EAAI,UACf,QAAS,CACL,IAAK,EAAI,QAAQ,QACjB,IAAK,EAAI,QAAQ,SACjB,KAAM,EAAI,QAAQ,WAEtB,WAAY,GAEhB,GAGM,IAAI,IACV,KACA,CACI,aACA,KAAM,EAAI,OACV,UAAW,EAAI,WAEnB,IAGJ,KAAK,QArVjB,kCAsVkB,KAAK,aAAa,EAAY,GAtVhD,gDAyVe,EAzVf,CA0VY,aA1VZ,iDAAM,gBAAN,GAAQ,OAAR,8BAAI,IAAJ,iBAAI,MAAJ,WAAM,IAAN,mCAqWgC,EAAoB,GArW5C,IAAR,UAAQ,OAAR,6DAsWa,KAAK,QAtWlB,sBAuWkB,IAAI,MAAM,4DAvW5B,WA0WY,EA1WZ,gBA2WYC,EAAMC,KAAKC,WAAWC,EAAYC,EAAW,IA3WzD,uCA6WgC,KAAK,aAAa,GA7WlD,UA6WgB,EA7WhB,OA6W+D,GA7W/D,0CA+WuB,MA/WvB,QAiXY,EAAM,KAAK,WAAW,EAAY,EAAW,IAjXzD,yBAmXyB,KAAK,QAAQ,KAAK,GAnX3C,WAmXY,EAnXZ,iDAqXmB,MArXnB,kBAyXY,EAAc,KAAK,MAAM,GAzXrC,yDA2XkB,IAAI,MAAJ,0DACiD,KAAM,SAAW,OAAM,MADxE,MA3XlB,WA+Xc,EAAU,IAAY,QAAQ,KAAM,IACtC,EAhYZ,kCAkYkB,KAAK,aAAa,EAAY,GAlYhD,iCAoYe,GApYf,2DAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,eAAI,MAAJ,WAAM,IAAN,mCA4Y8B,GA5YtB,IAAR,IAAQ,OAAR,6DA6Ya,KAAK,QA7YlB,sBA8YkB,IAAI,MAAM,0DA9Y5B,cAgZY,EAAM,KAAK,WAAW,EAAY,QAhZ9C,cAmZmB,KAnZnB,SAmZqC,KAAK,QAAQ,KAAK,GAnZvD,iDAmZgE,KAnZhE,kBAmZY,EAnZZ,KAmZwB,MAnZxB,wEAqZkB,IAAI,MAAJ,wDAC+C,KAAM,SAAW,OAAM,MADtE,MArZlB,iCAyZe,GAzZf,0DAAM,gBAAN,GAAQ,OAAR,8BAAI,IAAJ,gBAAI,MAAJ,WAAM,IAAN,mCAga+B,EAAoB,GAha3C,IAAR,EAAQ,OAAR,6DAiaa,KAAK,QAjalB,sBAkakB,IAAI,MAAM,2DAla5B,cAoaY,EAAM,KAAK,WAAW,EAAY,EAAW,IApazD,SAqac,KAAK,QAAQ,OAAO,GAralC,uBAsac,KAAK,aAAa,EAAY,GAAM,GAtalD,gDAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,gBAAI,MAAJ,WAAM,IAAN,mCA6a+B,GA7avB,IAAR,MAAQ,OAAR,6DA8aa,KAAK,QA9alB,sBA+akB,IAAI,MAAM,2DA/a5B,gCAibiC,KAAK,aAAa,GAjbnD,oGAibmB,EAjbnB,kBAkbkB,KAAK,cAAc,EAAY,GAlbjD,uMAAM,gBAAN,GAAQ,OAAR,8BAAI,IAAJ,wBAAI,MAAJ,SA8bQ,EACA,GAAyB,WAEzB,MAAO,CACH,iBAAgB,uCAAE,uGAAY,GAAZ,2CAAF,qDAChB,KAAI,uCAAE,WAAO,GAAP,kFACI,EAAU,IAAmB,gBAC/B,EAAK,QACL,EAAK,sBACL,EAAK,iBAED,YAAY,EAAK,qBAAqB,GAC9C,EAAQ,cAAa,GAPnB,SAQyB,EAAK,YAAY,EAAS,GARnD,uBAQK,EARL,EAQK,WARL,iCAUK,EAVL,CAWE,gBAXF,2CAAF,yDAnchB,CAAI,IAAJ,wBAAI,MAAJ,WAwdgC,IACjB,EAAO,KAAP,IACP,MAAO,CACG,gBADH,SACmB,GAAyC,4HACpD,EAA8B,EAA9B,cAAe,EAAe,EAAf,YADqC,SAEtC,EAAI,MAAM,8BAA+B,CAC1D,cACA,eAAgB,EAAc,IAAI,OAJqB,cAErD,EAFqD,yBAMpD,EAAO,cAAc,IAAI,MAN2B,iDA3d3E,CAAI,IAAJ,eAAI,MAAJ,WAAM,IAAN,mCAue+B,EAAoB,GAve3C,IAAR,sBAAQ,OAAR,iEAue0E,EAve1E,yCAwe0B,KAAK,aAAa,GAxe5C,cAweY,EAxeZ,OAyeY,EAAgB,EAAW,IAC3B,EAAW,EAAM,WAAU,SAAC,GAAD,OAAO,EAAW,KAAO,OACxC,GACZ,EAAM,OAAO,EAAU,IAEZ,IAAX,GACA,EAAM,QAAQ,GAEd,EAAM,KAAK,WAAW,EAAY,QAjf9C,UAkfc,KAAK,QAAS,MAAM,EAAK,KAAK,UAAU,IAlftD,iDAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,eAAI,MAAJ,WAAM,IAAN,mCAsf+B,EAAoB,GAtf3C,IAAR,IAAQ,OAAR,iEAufY,EAAM,KAAK,WAAW,EAAY,EAAW,EAAQ,OACrD,EAAO,KAAK,UAAU,EAAQ,aAxf1C,SAyfc,KAAK,QAAS,MAAM,EAAK,GAzfvC,uBA0fc,KAAK,aAAa,EAAY,EAAQ,MA1fpD,gDAAM,gBAAN,KAAQ,OAAR,8BAAI,IAAJ,aAAI,MAAJ,SA8fuB,EAAoB,GACnC,MAAO,CAAC,KAAK,QAAS,EAAY,GAAQ,KAAK,SA/fvD,KAugBA,SAAS,EAAgB,EAAa,GAClC,OAAO,IAAI,SAA6B,SAAC,EAAS,GAC9C,IAAI,GAAS,EACT,EAAU,EACR,EAAY,EAAI,QAAQ,QAAS,MACjC,EAAiB,SAAC,GACpB,IACI,EAAQ,KAAK,MAAM,IACrB,MAAO,GACL,EAAM,QAAU,kCAAoC,EAAM,QAC1D,EAAO,MAGC,SAAV,IACF,IAAM,EAAS,IAAI,IAAU,GAC7B,EAAI,OAAS,WACT,GAAS,EAEL,EAAO,aAAe,IAAU,MAChC,EAAO,aAAe,IAAU,YAEhC,EAAO,SAGf,EAAO,UAAY,SAAC,GAKhB,GAJA,GAAS,EACL,EAAO,aAAe,IAAU,MAChC,EAAO,QAES,qBAAT,MAAwB,EAAM,gBAAgB,KAAM,CAC3D,IAAM,EAAS,IAAI,WACnB,EAAO,OAAS,WACZ,EAAe,EAAO,SAE1B,EAAO,QAAU,SAAC,GACd,EAAO,IAEX,EAAO,WAAW,EAAM,UAEE,kBAAf,EAAM,KACb,EAAe,EAAM,MAErB,EAAe,EAAM,KAAK,aAItC,EAAO,OAAS,WACZ,EAAU,GAEd,EAAO,QAAU,SAAC,KAClB,EAAO,QAAU,SAAC,GAe9B,IAAiB,EAdG,GACA,WAAW,GAad,EAb+B,IAcrC,KAAK,IAAI,KAAK,IAAY,GAAR,EAAY,GAAI,QAVrC,MAiBR,SAAS,EAAW,GAAqB,IAChC,EAAqB,EAArB,MAAO,EAAc,EAAd,WAOZ,OANI,IAAU,MACV,EAAQ,SAER,IAAe,KAAuB,IAAe,MACrD,EAAa,SAEjB,UAAU,EAAV,YAAmB,M,0DCxoBvB,kCACO,IAAM,EAAW,CACpB,QAAS,mEACT,IAAK,2BACL,QAAS,2B,oBCrDbC,EAAOC,QAAU,IAA0B,oC,iCCA5B,KACXC,QAAS,iBACTC,MAAO,GACPC,QAAS,CACL,CACIC,KAAM,iBACNC,KAAM,GACNC,OAAQ,CACJ,CACIF,KAAM,OACNG,KAAM,cAEV,CACIH,KAAM,QACNG,KAAM,UAEV,CACIH,KAAM,aACNG,KAAM,SAEV,CACIH,KAAM,WACNG,KAAM,YAIlB,CACIH,KAAM,cACNC,KAAM,GACNC,OAAQ,CACJ,CACIF,KAAM,eACNG,KAAM,QAEV,CACIH,KAAM,cACNG,KAAM,gBAIlB,CACIH,KAAM,YACNC,KAAM,GACNC,OAAQ,CACJ,CACIF,KAAM,aACNG,KAAM,qBAKtBC,QAAS,GACTC,kBAAmB,GACnBC,eAAgB,GAChBC,OAAQ,GACRC,eAAgB,K,oBCvDpBb,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,kBCA3CD,EAAOC,QAAU,05K,oBCAjBD,EAAOC,QAAU,IAA0B,iC,2KCa9B,EAAb,kDAEI,WAAYa,GAAe,kCACvB,8CAA+B,EAAS,IAAM,EAAS,IAAM,MAF1D,KAAO,WACa,EAF/B,sBAAiC,QAWpB,EAAb,kDAEM,SAAF,EAAY,GAAe,kCACvB,SAAAlB,KAAA,oCAAmC,EAAS,IAAM,EAAS,IAAM,MAF9D,KAAO,aACa,EAF/B,sBAAmC,QAWtB,EAAb,kDAEI,WAAY,EAAgB,GAAgC,kCACxD,cAAM,IACD,KAAO,EAF4C,EAFhE,sBAAkC,S,qbC3BrB,EAAQ,MAAY,MAG3B,EAAQ,YAAU,gBAAgB,YAAU,qBAAsB,KAMlE,SAAU,EAAU,EAAY,GAClC,IAAI,EAAO,EAAM,IAAI,GACrB,IAAK,EACD,MAAM,IAAI,MAAJ,wBAA2B,IAErC,IAAI,EAAM,IAAI,YAAU,aAExB,OADA,EAAK,UAAU,EAAK,GACb,EAAI,eA2BT,SAAU,EAAY,EAAiB,EAAoB,GAC7D,IAAM,EAAM,MAAQ,QAAQ,EAAY,EAAW,GAOnD,OAAO,EANqB,CACxB,KAAM,kBAAoB,GAC1B,MAAO,EAAI,MAAM,WACjB,WAAY,EAAI,QAChB,SAAU,EAAI,UAEK,kBAOrB,SAAU,EAAmB,GAC/B,OAAI,EAAI,WAAW,QACR,EAEJ,UAAQ,kBAAkB,UAAQ,kBAAkB,MAAQ,EAAI,QAAQ,MAO7E,SAAU,EAAe,EAAc,GACzC,OAAO,EAAmB,KAAU,EAAmB,GAQ3D,SAAsB,IAAtB,+B,4CAAO,uFACmB,qBAAX,SAA0B,OAAO,OADzC,uBAEO,EAAO,IAAI,YAAY,IAC7B,OAAO,OAAO,gBAAgB,GAH/B,kBAIQ,aAAe,WAAW,EAAO,KAAK,IAAO,YAJrD,uBAMc,cANd,oF,4OC7EQ,G,kBAAA,EAAf,G,SCNM,EAAkB,CACpB,mEACI,gC,SAGO,E,gFAAf,WAAuB,EAAa,GAAhC,OAAJ,sBAAM,OAAE,OAAR,sCAEc,MAAM,EAAK,CACb,OAAQ,OACR,QAAS,CACL,eAAgB,oBAEpB,KAAM,EAAO,KAAK,UAAU,QAAQ,IAPhD,uCASM,QATN,4C,sBAYA,SAAsB,EAAtB,KAAE,OAAF,wB,4CAAO,WAAoB,EAAyB,GAA7C,8EACG,EAAU,EAAQ,aAClB,EAAU,EAAgB,GAF7B,sBAIO,IAAI,MAAM,gCAJjB,uBAMkB,EAAQ,EAAU,oBAAqB,CACxD,QAAS,EACT,OAAQ,EAAQ,OARjB,YAMG,EANH,QAUQ,KAAK,WAAW,GAVxB,iBAWC,EAAQ,WAAW,WAAY,EAAO,KAAK,WAAW,IAXvD,8BAaO,IAAI,MAAM,mCAbjB,eAgBH,EAAQ,KAAK,IAAM,EAAO,KAAK,QAhB5B,kBAiBI,GAjBJ,6C,0BDID,E,WACA,SAAF,EAAqB,GAAiB,oBAAjB,iB,2FACT,EAAa,G,iEACrB,aAAa,QAAQ,KAAK,WAAW,GAAM,G,6KAEpC,G,0FACA,aAAa,QAAQ,KAAK,WAAW,K,6KAEnC,G,iEACT,aAAa,WAAW,KAAK,WAAW,I,wIAEjC,GACP,gBAAU,KAAK,UAAf,YAA4B,O,KAIf,E,WAGf,SAAF,IAAiE,IAArC,EAAqC,uDAAF,GAAE,oBAArC,eACpB,KAAC,YAAc,EAAQ,aAAe,cACtC,KAAC,gBAA0C,IAAzB,EAAQ,cAC1B,KAAC,iBAA4C,IAA1B,EAAQ,eAC3B,KAAC,aAA6C,IAA/B,EAAQ,mBACvB,KAAC,QAAU,IAAI,EAAQ,EAAQ,eAAiB,e,4DAenC,WACjB,GAAI,KAAK,eAAiB,KAAK,QAAS,CACpC,KAAK,QAAU,SAAS,cAAc,SACtC,KAAK,QAAQ,KAAO,WACpB,IAAM,EEnEH,omHFmEmB,QAAQ,YAAa,KAAK,aACxC,KAAH,QAAQ,YAAY,SAAS,eAAe,IACzC,SAAC,KAAK,YAAY,KAAK,SAkBnC,GAhBK,KAAK,cACE,KAAH,YAAc,KAAK,WAChB,KAAH,YAAY,UAAY,KAAK,YAC1B,KAAH,YAAY,QAAU,SAAC,GACpB,EAAM,SAAW,EAAK,cACtB,EAAM,kBACN,EAAK,OACD,EAAK,eACL,EAAK,mBAAgB,EACrB,EAAK,aAAa,gBAClB,EAAK,kBAAe,KAIhC,SAAS,KAAK,YAAY,KAAK,eAE9B,KAAK,UAAW,CACjB,IAAI,EAAU,KAAK,SAAS,CAAC,MAAO,UACpC,KAAK,UAAY,KAAK,SAAS,CAAC,MAAO,YACvC,EAAQ,YAAY,KAAK,WACzBA,KAAKmB,YAAY,YAAY,M,+BAIpB,GACR,IAAO,EAAQ,IACpB,IAAM,EAAK,SAAS,cAAc,EAAM,KAAO,OAC/C,GAAI,EACA,cAAmB,OAAO,KAAK,GAA/B,eAAuC,CAAlC,IAAM,EAAI,KACL,EAAQ,EAAM,GACpB,OAAQ,GACJ,IAAK,MACD,MACJ,IAAK,OACD,EAAG,YAAY,SAAS,eAAe,IACvC,MACJ,IAAK,QACD,EAAG,UAAH,UAAkB,KAAK,YAAvB,YAAsC,GACtC,MACJ,QACI,EAAG,aAAa,EAAM,IAItC,OAAO,I,6BAIH,KAAK,aACL,KAAK,YAAY,UAAU,OAA3B,UAAqC,KAAK,YAA1C,YAEJ,KAAK,gB,6BAID,KAAK,aACL,KAAK,YAAY,UAAU,IAA3B,UAAkC,KAAK,YAAvC,c,8EAIqB,G,wGACzBnB,KAAK,iBAED,EAAoB,EAAQ,SACd,WAAW,eAAe,GAC5C,EAAkB,WAAW,cAAe,KAExC,EAAgB,EAAkB,QAAO,GAAM,GAC/C,EAAiB,EAAQ,QAAO,GAAM,GAEpC,EAAa,EAAQ,aACrB,EAAQ,EAAa,QAAU,OAC/B,EAAW,yCAEX,EAAO,KAAK,SAAS,CAAC,MAAO,O,UACZ,WAAgB,EAAgB,CACnD,OAAQ,EACR,qBAAsB,M,QAF1B,EAAK,U,OAKC,EAAS,KAAK,SAAS,CAAC,MAAO,SAC/B,EAAQ,KAAK,SAAS,CACxB,IAAK,IACL,KAAM,EACN,KAAM,qBAEJ,iBAAiB,SAAS,SAAC,GAC7B,EAAM,iBACN,OAAO,SAAS,KAAO,KAE3B,EAAO,YAAY,GAEb,EAAS,KAAK,SAAS,CAAC,MAAO,SAC/B,EAAY,KAAK,SAAS,CAAC,MAAO,QAAS,IAAK,OAAQ,KAAM,IAC9D,EAAe,KAAK,SAAS,CAAC,MAAO,WAAY,IAAK,OAAQ,KAAM,IAC1E,EAAO,YAAY,GACnBoB,EAAOC,YAAY,IAEb,EAAW,KAAK,SAAS,CAAC,MAAO,aAC9B,YAAY,GACrB,EAAS,YAAY,GAErB,EAAa,KAAK,WAEZ,EAAS,KAAK,SAAS,CAAC,MAAO,SACrC,KAAK,UAAU,YAAY,GAC3B,KAAK,UAAU,YAAY,GAC3B,KAAK,UAAU,YAAY,GAE3BrB,KAAK,O,wIAGQ,EAAyB,GACtC,KAAK,cAAgB,EACrB,KAAK,aAAe,EACpB,KAAK,eAAe,GAAS,MAAM,K,uCAInC,EACA,EACA,GAMA,GAJI,EAAQ,SAAS,YACjB,EAAQ,WAAW,cAAe,KAGjB,aAAjB,EAAQ,KAMR,OALA,KAAK,UAAU,EAAS,QACpB,EAAQ,SAAS,aAEjB,OAAO,SAAS,KAAO,EAAQ,WAKvC,KAAK,cAAgB,EACrB,KAAK,aAAe,EACpB,KAAK,gBAEL,IAAM,EAAU,EAAQ,SAAS,SAAW,KACtC,EAAa,EAAQ,SAAS,KAE9B,EAAQ,KAAK,MACb,EAAY,KAAK,SAAS,CAAC,MAAO,QAAS,IAAK,OAAQ,KAAM,SAE9D,EAAkB,WACpB,IAAM,EAAW,EAAU,EAAQ,KAAK,MAClC,EACF,EAAW,EAAI,IAAI,KAAK,GAAU,cAAc,OAAO,GAAI,GAAK,QACpE,EAAU,YAAV,iBAAkC,IAEhC,KAAD,eAAiB,YAAY,EAAiB,KAC7C,IAEA,IAGF,EAHE,EAAS,KAAK,SAAS,CAAC,MAAO,SAC/B,EAAC,YAAY,GAIf,EADA,GAAc,EAAW,OAAS,EAC1B,0CAAiC,EAAjC,8CAEG,+DAGf,IAAM,EAAe,KAAK,SAAS,CAAC,MAAO,WAAY,IAAK,OAAQ,KAAM,IAC1E,EAAO,YAAY,GAEb,EAAO,KAAK,WACZ,MAAS,KAAK,SAAS,CAAC,MAAO,SAC/B,KAAD,UAAU,YAAY,GACrB,KAAD,UAAU,YAAY,GACrB,KAAD,OA6GF,kBAAkB,KAAK,UAAU,YA3GX,EAAQ,SAAS,aAC9B,OAAD,SAAS,KAAO,mB,oCAKvB,KAAK,aACL,aAAa,KAAK,YAClB,KAAK,gBAAa,GAElB,KAAK,iBACL,aAAa,KAAK,gBAClB,KAAK,oBAAiB,K,uEAIT,EAAyB,G,oEACrC,KAAK,aAAgB,IAAW,EAAQ,a,yCAElC,G,gCAGM,EAAK,EAAS,G,wEAE3B,QAAQ,KAAR,6BAAmC,KAAM,QAAzC,M,iCAEG,G,kJAGM,GAAuB,WACpC,GAAI,IAAY,KAAK,cAEjB,GADA,KAAK,cACD,KAAK,cAAe,CACpB,KAAK,gBACL,IAAM,EAAS,KAAK,SAAS,CAAC,MAAO,SAC/B,EAAS,KAAK,SAAS,CAAC,MAAO,SACrC,EAAO,UAAU,IAAI,WACrB,IAAM,EAAY,KAAK,SAAS,CAAC,MAAO,QAAS,IAAK,OAAQ,KAAM,aAC9D,EAAW,EAAQ,aAAe,mBAAqB,sBACvD,EAAe,KAAK,SAAS,CAAC,MAAO,WAAY,IAAK,OAAQ,KAAM,IAC1E,EAAO,YAAY,GACnB,EAAO,YAAY,GACnB,EAAa,KAAK,WAClB,KAAK,UAAU,YAAY,GAC3B,KAAK,UAAU,YAAY,GAC3B,KAAK,OACL,KAAK,WAAa,YAAW,WACzB,EAAK,SACN,WAEH,KAAK,S,gCAKA,EAAyB,GAAY,WAClD,GAAI,IAAY,KAAK,cAEjB,GADA,KAAK,cACD,KAAK,cAAe,CACpB,KAAK,gBACL,IAAM,EAAS,KAAK,SAAS,CAAC,MAAO,SAC/B,EAAS,KAAK,SAAS,CAAC,MAAO,SACrC,EAAO,UAAU,IAAI,SACrB,IAAM,EAAY,KAAK,SAAS,CAC5B,MAAO,QACP,IAAK,OACL,KAAM,sBAEJ,EAAe,KAAK,SAAS,CAC/B,MAAO,WACP,IAAK,OACL,KAAM,EAAM,SAAW,OAAO,KAElC,EAAO,YAAY,GACnB,EAAO,YAAY,GACnB,EAAa,KAAK,WAClB,KAAK,UAAU,YAAY,GAC3B,KAAK,UAAU,YAAY,GAC3B,KAAK,OACL,KAAK,WAAa,YAAW,WACzB,EAAK,SACN,UAEH,KAAK,W,KAMrB,SAAS,EAAa,GAClB,KAAO,EAAG,YACN,EAAG,YAAY,EAAG,YAI1B,IAAM,EAAoB,iEACpB,EAAuB,EAAkB,OAE/C,SAAS,IAEL,IADA,IAAI,EAAK,OAAO,SAAS,KAAK,MAAM,KAAK,GAAK,IACrC,EAAI,EAAG,EAAI,EAAG,IACnB,GAAM,EAAkB,OAAO,KAAK,MAAM,KAAK,SAAW,IAE9D,OAAO,E,8BGnRIsB,E,uKArEH,IAAD,SAC8BtB,KAAKuB,MAAlCC,EADD,EACCA,MAAOC,EADR,EACQA,QAASC,EADjB,EACiBA,SACxB,OACE,kBAACC,EAAA,EAAD,KACE,kBAACA,EAAA,EAAMC,OAAP,KACE,kBAACD,EAAA,EAAME,IAAP,KACE,kBAACF,EAAA,EAAMG,WAAP,CAAkBC,YAAU,GAAEP,EAAMf,MACpC,kBAACkB,EAAA,EAAMG,WAAP,gBACA,kBAACH,EAAA,EAAMG,WAAP,mBACA,kBAACH,EAAA,EAAMG,WAAP,QAGFJ,EAASM,OAEP,kBAACL,EAAA,EAAMM,KAAP,KACGP,EAASQ,KAAI,SAACC,GACb,IAAMC,EAAaX,GAAWA,EAAQY,MAAQF,EAAEG,QAAUb,EAAQY,KAAKC,OAASH,EAAEI,aAAed,EAAQY,KAAKE,WACxGxC,EAAMyC,OAAOC,OAAON,GAAGO,KAAK,KAClC,OACE,kBAACf,EAAA,EAAME,IAAP,CAAW9B,IAAKA,GACd,kBAAC4B,EAAA,EAAMgB,KAAP,CAAYZ,YAAU,GACpB,kBAACa,EAAA,EAAD,CACEC,MAAOT,EAAY,OAAS,QAC5BU,QAASV,EAAY,SAAW,cAChCW,SAAUX,EACVY,QAAS,kBAAM,EAAKzB,MAAM0B,WAAWd,OAGzC,kBAACR,EAAA,EAAMgB,KAAP,KAAaR,EAAEG,OACf,kBAACX,EAAA,EAAMgB,KAAP,KAAaR,EAAEI,YACf,kBAACZ,EAAA,EAAMgB,KAAP,CAAYZ,YAAU,GACpB,kBAACa,EAAA,EAAD,CACEC,MAAM,MACNK,KAAK,QACLF,QAAS,kBAAM,EAAKzB,MAAM4B,cAAchB,YASpD,kBAACR,EAAA,EAAMM,KAAP,KACE,kBAACN,EAAA,EAAME,IAAP,CAAWuB,UAAU,UACnB,kBAACzB,EAAA,EAAMgB,KAAP,CAAYU,QAAQ,KAApB,0BAKR,kBAAC1B,EAAA,EAAM2B,OAAP,CAAcC,WAAS,GACrB,kBAAC5B,EAAA,EAAME,IAAP,KACE,kBAACF,EAAA,EAAMG,WAAP,MACA,kBAACH,EAAA,EAAMG,WAAP,CAAkBuB,QAAQ,IAAID,UAAU,UACtC,kBAACR,EAAA,EAAD,CACEY,OAAK,EACLV,QAAQ,cACRW,OAAK,EACLT,QAAShD,KAAKuB,MAAMmC,WACpBC,SAAO,Y,GA5DHC,a,qHCSdC,EAAU,CACd,mEAAoEC,IACpE,iEAAoEC,IACpE,iEAAoEC,IACpE,mEAAoEA,IACpE,mEAAoEC,IACpE,mEAAoEC,IACpE,iEAAoEC,KAGhEC,EAAUC,EAAYnC,KAAI,SAACV,GAAD,MAAY,CAC1CzB,IAAKyB,EAAM8C,QACXC,KAAM/C,EAAMf,KACZ+D,MAAOhD,EAAM8C,QACbG,MAAO,CACLC,QAAQ,EACRC,IAAKd,EAAQrC,EAAM8C,cAsBRM,E,uKAhBH,IACApD,EAAUxB,KAAKuB,MAAfC,MACR,OACE,kBAACqD,EAAA,EAAD,CACEpB,OAAK,EACLqB,SAAU9E,KAAKuB,MAAMuD,SACrBV,QAASA,EACTW,YAAY,uBACZC,QAAM,EACNC,WAAS,EACTT,MAAOhD,EAAM8C,c,GAXKV,a,kBCdXsB,G,uKAdH,IACAC,EAAUnF,KAAKuB,MAAf4D,MAER,OADAC,QAAQC,IAAIF,GAEV,kBAACG,EAAA,EAAD,CAASzC,MAAM,MAAM0C,KAAK,SACxB,kBAAC3D,EAAA,EAAD,CAAQ2D,KAAK,SAAb,kCAGCJ,EAAMK,a,GATY5B,a,sCCErB6B,GAAiBC,EAAQ,KACzBC,GAAgDC,aAAUC,gBAAgBD,aAAUE,qBAAsBL,IAmJjGM,G,4MAhJbC,aAAe,WAAO,IACZC,EAAa,EAAK1E,MAAlB0E,SA+CR,MA9Cc,CACZ,CACExF,KAAM,gCACNyF,KAAM,sDACNC,KAAM,SAACC,GAAD,SAAUA,EAAEC,YAAcD,EAAEC,WAAWrE,QAAU,IACvDsE,KAAM,SAACF,GAAD,OAAOG,KAAKC,UAAUJ,EAAEC,cAEhC,CACE5F,KAAM,8CACNyF,KAAM,uEACNC,KAAM,SAACC,GAAD,QAAUA,EAAEK,aAClBH,KAAM,SAACF,GAAD,OAAOG,KAAKC,UAAUJ,EAAEK,eAEhC,CACEhG,KAAM,4CACNyF,KAAM,oEACNC,KAAM,SAACC,GAAD,QAAUA,EAAEM,uBAClBJ,KAAM,SAACF,GAAD,OAAOG,KAAKC,UAAUJ,EAAEM,yBAEhC,CACEjG,KAAM,mDACNyF,KAAM,mFACNC,KAAM,SAACC,GACL,IACE,IAAMO,EAAK,EAAKC,YAAYR,EAAEM,uBAC9B,OACEC,EAAGE,YACAF,EAAG9F,SACH8F,EAAG9F,QAAQmB,OAAS,GACpB2E,EAAGG,cAAgB,GACnBH,EAAGI,iBAAmB,EAE3B,MAAOC,GACP,OAAO,IAGXV,KAAM,SAACF,GACL,IACE,IAAMO,EAAK,EAAKC,YAAYR,EAAEM,uBAC9B,OAAOH,KAAKC,UAAUG,GACtB,MAAOK,GACP,OAAOT,KAAKC,UAAU,QAKjBtE,KAAI,SAAC+E,GAChB,OAAO,gBACFA,EADL,CAEEC,IAAKD,EAASd,KAAKF,GACnBkB,IAAKF,EAASX,KAAKL,S,EAIzBW,YAAc,SAACQ,GACb,IAAMC,EAAS,IAAIzB,aAAU0B,aAAa,CACxCC,MAAOH,IAGT,OADazB,GAAiB6B,IAAI,eACtBZ,YAAYS,I,uDAEhB,IACApB,EAAajG,KAAKuB,MAAlB0E,SACFwB,EAAQzH,KAAKgG,eACnB,OACE,kBAAC,IAAM0B,SAAP,KACE,kBAACpC,EAAA,EAAD,CAASqC,MAAO,CAAEC,UAAW,WAC3B,kBAACC,GAAA,EAAD,CAAMC,SAAO,EAACC,SAAO,GAClBN,EAAMvF,KAAI,SAAAiE,GAAI,OACb,kBAAC0B,GAAA,EAAKG,KAAN,KACE,kBAACH,GAAA,EAAKI,KAAN,CACEpF,MAAOsD,EAAKe,IAAM,QAAU,MAC5BzG,KAAM0F,EAAKe,IAAM,YAAc,IAC/B3B,KAAK,QACL2C,cAAc,QAEhB,kBAACL,GAAA,EAAKM,QAAN,KACE,kBAACN,GAAA,EAAKjG,OAAN,KAAcuE,EAAK1F,MACnB,kBAACoH,GAAA,EAAKO,YAAN,KAAmBjC,EAAKD,MACxB,kBAAC2B,GAAA,EAAKM,QAAN,CAAcR,MAAO,CAAEU,OAAQ,YAAa,8BAAOlC,EAAKgB,aAMlE,kBAAC7B,EAAA,EAAD,CAASqC,MAAO,CAAEW,WAAY,oBAC5B,kBAAC1G,EAAA,EAAD,CAAQ2G,UAAQ,EAAChD,KAAK,QAAQoC,MAAO,CAAEa,aAAc,kBAAmB3F,MAAO,UAA/E,oBAGA,kBAAC,KAAD,CACE0B,KAAI,iCACJkE,SAAU,aACVC,iBAAiB,EACjBC,MAAOC,KACPC,WAAS,IAEX,kBAAC,IAAD,CACEC,kBAAkB,EAClBC,mBAAmB,EACnBC,iBAAiB,EACjBC,UAAU,SACVxI,KAAM,KACNkE,IAAKsB,EAASiD,QACdvB,MAAO,CACLW,WAAY,kBACZa,UAAW,MACXC,SAAU,UAEZT,MAAM,cAGV,kBAACrD,EAAA,EAAD,CAASqC,MAAO,CAAEW,WAAY,oBAC5B,kBAAC1G,EAAA,EAAD,CAAQ2G,UAAQ,EAAChD,KAAK,QAAQoC,MAAO,CAAEa,aAAc,kBAAmB3F,MAAO,UAA/E,UAGA,kBAAC,KAAD,CACE0B,KAAI,gCACJkE,SAAU,aACVC,iBAAiB,EACjBC,MAAOC,KACPC,WAAS,IAEX,kBAAC,IAAD,CACEC,kBAAkB,EAClBC,mBAAmB,EACnBC,iBAAiB,EACjBC,UAAU,SACVxI,KAAM,KACNkE,IAAKsB,EAASoD,OACd1B,MAAO,CACLW,WAAY,kBACZa,UAAW,MACXC,SAAU,UAEZT,MAAM,mB,GAzIQ/E,aCyPX0F,G,kDA7Ob,WAAY/H,GAAQ,IAAD,uBACjB,cAAMA,IAwBRmC,WAzBmB,sBAyBN,gCAAA6F,EAAA,6DACHjF,EAAY,EAAKkF,MAAjBlF,QADG,kBAIc,EAAKmF,KAAKC,MAAM,6BAA8B,CAAEpF,YAJ9D,cAIHqF,EAJG,gBAMc,EAAKF,KAAKG,aAAa,8BANrC,OAMHlI,EANG,OAQT,EAAKmI,SAAS,CACZ1E,WAAO2E,EACP7D,cAAU6D,EACVrI,QAASkI,EAASlI,QAClBC,aAZO,kDAeT0D,QAAQC,IAAR,MAfS,0DAzBM,EA2CnB0E,cA3CmB,sBA2CH,oCAAAR,EAAA,6DAENjF,EAAY,EAAKkF,MAAjBlF,QAEF0F,EAAaC,eAAK5F,EAAa,CAAEC,YACjC4F,EAAMF,EAAWG,aAAa,GAEpC,EAAKV,KAAO,IAAIW,EAAW,CAEzB9F,UAEA4F,IAAI,GAAD,OAAKA,EAAIG,SAAT,cAAuBH,EAAII,KAA3B,YAAmCJ,EAAIK,MAE1CC,QAAS,yBAETC,UAAW,IAAIC,EAA2B,CAExCC,oBAAoB,EAEpBC,eAAe,MAnBL,SAuBQ,EAAKnB,KAAKoB,eAAe,8BAvBjC,cAuBRpJ,EAvBQ,gBAyBS,EAAKgI,KAAKG,aAAa,8BAzBhC,cAyBRlI,EAzBQ,OA2Bd,EAAKmI,SAAS,CACZvF,UACAa,WAAO2E,EACPrI,UACAC,aA/BY,kBAkCP,EAAK+H,MAlCE,4CA3CG,EA+EnBqB,gBA/EmB,sBA+ED,gCAAAvB,EAAA,6DAER9H,EAAY,EAAK+H,MAAjB/H,QAFQ,SAKd,EAAKoI,SAAS,CAAE5D,cAAU6D,IACpBiB,EAAS,CACbC,QAAS,QACTvK,KAAM,eACNwK,cAAe,CAACxJ,EAAQY,MACxBiE,KAAM,CACJ4E,UAAW,GAEXC,MAAO,eACPC,MAAO3J,EAAQY,KAAKC,QAdV,SAkBSb,EAAQ4J,SAAS,CACtCxK,QAAS,CAACkK,IACT,IApBW,OAkBR9E,EAlBQ,OAmCd,EAAK4D,SAAS,CACZ1E,WAAO2E,EACP7D,aArCY,kDAwCdb,QAAQC,IAAR,MACA,EAAKwE,SAAS,CAAE1E,MAAM,EAAD,KAzCP,0DA/EC,EA4HnBmG,WAAa,SAACtE,EAAD,OAAMxC,EAAN,EAAMA,MAAN,OAAkB,EAAKqF,SAAS,CAC3CvF,QAASE,EACTW,WAAO2E,EACP7D,cAAU6D,IACT,WACD,IAAMyB,EAAe,IAAIC,gBAAgBC,OAAOC,SAAS1G,QACzDuG,EAAaI,IAAI,UAAWnH,GAC5BiH,OAAOG,QAAQC,UAAU,KAAM,KAA/B,WAAyCN,EAAaO,iBAnIrC,EAsInB7I,WAtImB,uCAsIN,WAAOZ,GAAP,eAAAkH,EAAA,sEAEW,EAAKE,KAAKoB,eAAe,6BAA8BxI,GAFlE,OAELZ,EAFK,OAIX,EAAKoI,SAAS,CACZ1E,WAAO2E,EACP7D,cAAU6D,EACVrI,YAPS,2CAtIM,wDAiJnB0B,cAjJmB,uCAiJH,WAAOd,GAAP,mBAAAkH,EAAA,sEAER,EAAKE,KAAKtG,cAAc,6BAA8Bd,GAF9C,SAIgB,EAAKmH,MAA3B/H,EAJM,EAINA,QAASC,EAJH,EAIGA,SAEbD,GAAWA,EAAQY,KAAKC,QAAUD,EAAKC,OAASb,EAAQY,KAAKE,aAAeF,EAAKE,YACnF,EAAKsH,SAAS,CAAEpI,aAASqI,IAE3B,EAAKD,SAAS,CACZnI,SAAUA,EAASqK,QAAO,SAAA5J,GAAC,QAAMA,EAAEG,QAAUD,EAAKC,OAASH,EAAEI,aAAeF,EAAKE,iBAVrE,2CAjJG,sDAGjB,IAAMyC,EAASyG,OAAOC,SAAS1G,OAEzBV,EADS,IAAIkH,gBAAgBxG,GACZwC,IAAI,YAAc,mEALxB,OAOjB,EAAKgC,MAAQ,CACXrE,WAAO2E,EACP7D,cAAU6D,EACVrI,aAASqI,EACTpI,SAAU,GACV4C,WAZe,E,gEAiBjBtE,KAAK+J,kB,yCAEYiC,EAAWC,GAExBjM,KAAKwJ,MAAMlF,UAAY2H,EAAU3H,SACnCtE,KAAK+J,kB,+BAwIA,MAQH/J,KAAKwJ,MALPlF,EAHK,EAGLA,QACAa,EAJK,EAILA,MACA1D,EALK,EAKLA,QACAC,EANK,EAMLA,SACAuE,EAPK,EAOLA,SAGIzE,EAAQyI,eAAK5F,EAAa,CAAEC,YAElC,OACE,kBAAC4H,EAAA,EAAD,CACEvE,MAAO,CAAEwE,WAAY,QAErB,kBAACvK,EAAA,EAAD,CAAQwK,SAAS,MAAMC,OAAK,EAAC9G,KAAK,QAAlC,6BAEE,kBAAC3D,EAAA,EAAO0K,UAAR,KACE,kIACA,2CAAgB,uBAAGC,KAAK,0DAAR,6DAGpB,kBAACjH,EAAA,EAAD,CAAS8G,UAAQ,EAACI,QAAM,GACtB,+DACA,kBAAC,EAAD,CACEhL,MAAOA,EACPsD,SAAU9E,KAAKsL,cAGnB,kBAAChG,EAAA,EAAD,CAAS8G,UAAQ,EAACI,QAAM,GACtB,kBAAC5K,EAAA,EAAD,2BACA,kBAAC6K,EAAD,CACE/I,WAAY1D,KAAK0D,WACjBlC,MAAOA,EACPC,QAASA,EACTC,SAAUA,EACVuB,WAAYjD,KAAKiD,WACjBE,cAAenD,KAAKmD,iBAGxB,kBAACmC,EAAA,EAAD,CAAS8G,UAAQ,EAACI,QAAM,GACtB,kBAAC5K,EAAA,EAAD,kCACA,kBAACgB,EAAA,EAAD,CACEE,QAAQ,wBACRC,UAAWtB,EACXyB,KAAK,WACLF,QAAShD,KAAK8K,gBACdnH,SAAO,EACP4B,KAAK,UAEJ9D,GACC,uBAAGkG,MAAO,CAAEwB,UAAW,UAAvB,wDAIN,kBAAC7D,EAAA,EAAD,CAAS8G,SAAS,SAASI,QAAM,KAC7BrH,GAEE,kBAAC,GAAD,CACEA,MAAOA,MAKXc,GAEE,kBAACyG,GAAD,CACEzG,SAAUA,U,GApORrC,aCPE+I,QACW,cAA7BlB,OAAOC,SAASkB,UAEe,UAA7BnB,OAAOC,SAASkB,UAEhBnB,OAAOC,SAASkB,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,GAAD,MACAC,SAASC,eAAe,SD2HpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAArI,GACLC,QAAQD,MAAMA,EAAMK,a,yNE5HN,EAAtB,WAAE,SAAF,IAAI,oBAAF,uBAAE,IAAJ,SAAI,MAAJ,yHAkCY,KAAK,KAAK,QAlCtB,gCAmCkB,KAAK,KAAK,cAAc,KAAK,WAAY,KAAK,MAnChE,yGAAI,IAAJ,UAAI,MAAJ,SAuCmB,EAAY,GACvB,OAAQ,EAAK,MACT,IAAK,UACD,OAAO,IAAI,EAAmB,EAAM,EAAK,KAAM,EAAK,UACxD,IAAK,WACD,OAAO,IAAI,EAAoB,EAAM,EAAK,KAAM,EAAK,UACzD,QACI,MAAM,IAAI,MAAM,gDA9ChC,KAsFa,EAAb,YAAE,qBAAF,iBAYI,WAAY,EAAY,EAA8B,GAAa,kCAC/D,gBATK,KAAO,UAKR,UAAU,KAKd,EAAK,KAAO,EACZ,EAAK,KAAO,EAAK,KACjB,EAAK,UAAY,EAAK,UACtB,EAAK,QAAU,EAAK,QACpB,EAAK,WAAa,EAAK,WACvB,EAAK,QAAU,SAAC,GACZ,OAAO,YAAY,EAAQ,QAAO,GAAM,GAAQ,EAAK,WAAY,EAAK,QAAQ,MAElF,EAAK,SAAL,eACQ,GAAY,GADpB,CAEI,QAAS,EAAK,QACd,KAAM,EAAK,QAAQ,OAEvB,EAAK,UAAY,iBAAO,CACpB,KAAM,UACN,OACA,SAAU,EAAK,WAlB4C,EAZrE,uBAAE,IAAJ,YAAI,MAAJ,SAkCc,EAAS,GACX,KAAK,KAAK,UAAU,WACpB,KAAK,KAAK,UAAU,UAAU,EAAS,KApCnD,CAAI,IAAJ,YAAI,MAAJ,SAwCc,EAAS,GACX,KAAK,KAAK,UAAU,WACpB,KAAK,KAAK,UAAU,UAAU,EAAS,KA1CnD,CAAI,IAAJ,YAAI,MAAJ,SA8Cc,EAAS,GACf,IAAM,EAAiB,CACnB,WAAY,IAAI,KAAK,KAAK,MAAQ,KAAK,SAAS,cAAc,MAAM,GAAI,IAExExF,KAAKyJ,KAAKgB,UAAUgD,kBACpB,KAAK,KAAK,UAAU,iBAAiB,KAAM,EAAS,GAExD,YAAW,WACP,EAAO,IAAI,IAAa,iCAAkC,gBAC3D,KAAK,QAAU,KAClB,EAAQ,KAAK,KAAK,KAAK,CACnB,IAAK,OACL,MAAO,YAAU,EAAM,eAE3B,YAAM,KAAK,QAAQ,IAAK,CACpB,OAAQ,OACR,QAAS,CACL,eAAgB,KAAK,QAAU,KAAM,QAAQ,IAEjD,KAAM,KAAK,QAAQ,KAElB,MAAK,SAAC,GACqB,MAApB,EAAS,QACT,EAAO,IAAI,IAAa,yBAA0B,kBAKzD,OAAM,SAAC,GACJ,EACI,IAAI,IAAJ,wCACqC,EAAM,SAAW,OAAO,GAD7D,KAEI,oBA9ExB,CAAI,IAAJ,UAAI,MAAJ,SAoFY,GACJ,OAAI,KAAK,KAAK,UAAU,QACb,KAAK,KAAK,UAAU,QAAQ,EAAS,MAEzC,QAAQ,QAAQ,KAxF/B,CAAI,IAAJ,wBAAI,MAAJ,WA4FQ,OAAO,KAAK,KAAK,sBAAsB,CAAC,KAAK,WAAY,QA5FjE,CAAI,IAAJ,wBAAI,MAAJ,WAgGQ,OAAO,KAAK,KAAK,0BAhGzB,CAAI,IAAJ,WAAI,MAAJ,SAmGa,EAAoB,GACzB,OAAO,KAAK,KAAK,SAAS,EAAM,EAAS,UApGjD,GAAwC,GAsH3B,EAAb,kDAYI,WAAY,EAAY,EAA+B,GAAa,kCAChE,gBAPK,KAAO,WAQZ,EAAK,KAAO,EACZ,EAAK,KAAO,EAAK,KACjB,EAAK,UAAY,EAAK,UACtB,EAAK,SAAW,GAAY,GAC5B,EAAK,WAAa,EAAK,WACvB,EAAK,UAAY,iBAAO,CACpB,KAAM,EAAK,KACX,OACA,SAAU,EAAK,WAV6C,EAZxE,sDA0Bc,EAAS,GACX,KAAK,KAAK,UAAU,WACpB,KAAK,KAAK,UAAU,UAAU,EAAS,KA5BnD,gCAgCc,EAAS,GACX,KAAK,KAAK,UAAU,WACpB,KAAK,KAAK,UAAU,UAAU,EAAS,KAlCnD,gCAsCc,EAAS,GACX,KAAK,KAAK,UAAU,iBACpB,KAAK,KAAK,UAAU,iBAAiB,KAAM,EAAS,GAEpD,KAAK,KAAK,UAAU,UAAU,EAAS,KA1CnD,8BA8CY,GACJ,OAAI,KAAK,KAAK,UAAU,QACb,KAAK,KAAK,UAAU,QAAQ,EAAS,MAEzC,QAAQ,QAAQ,KAlD/B,8CAsDQ,OAAO,KAAK,KAAK,sBAAsB,CAAC,KAAK,WAAY,QAtDjE,8CA0DQ,OAAO,KAAK,KAAK,0BA1DzB,+BA6Da,EAAoB,GACzB,OAAO,KAAK,KAAK,SAAS,EAAM,EAAS,UA9DjD,GAAyC,I","file":"static/js/main.45489505.chunk.js","sourcesContent":["import * as esr from 'eosio-signing-request';\nimport { JsonRpc } from 'eosjs';\nimport * as ecc from 'eosjs-ecc';\nimport WebSocket from 'isomorphic-ws';\nimport zlib from 'pako';\nimport { v4 as uuid } from 'uuid';\nimport { CancelError, IdentityError } from './errors';\nimport { defaults } from './link-options';\nimport { LinkChannelSession, LinkFallbackSession, LinkSession } from './link-session';\nimport { abiEncode, fetch, generatePrivateKey, normalizePublicKey, publicKeyEqual } from './utils';\n/**\n * Main class, also exposed as the default export of the library.\n *\n * Example:\n *\n * ```ts\n * import AnchorLink from 'anchor-link'\n * import ConsoleTransport from 'anchor-link-console-transport'\n *\n * const link = new AnchorLink({\n *     transport: new ConsoleTransport()\n * })\n *\n * const result = await link.transact({actions: myActions})\n * ```\n */\nexport class Link {\n    /** Create a new link instance. */\n    constructor(options) {\n        this.abiCache = new Map();\n        this.pendingAbis = new Map();\n        if (typeof options !== 'object') {\n            throw new TypeError('Missing options object');\n        }\n        if (!options.transport) {\n            throw new TypeError('options.transport is required, see https://github.com/greymass/anchor-link#transports');\n        }\n        if (options.rpc === undefined || typeof options.rpc === 'string') {\n            this.rpc = new JsonRpc(options.rpc || defaults.rpc, { fetch: fetch });\n        }\n        else {\n            this.rpc = options.rpc;\n        }\n        if (options.chainId) {\n            this.chainId =\n                typeof options.chainId === 'number'\n                    ? esr.nameToId(options.chainId)\n                    : options.chainId;\n        }\n        else {\n            this.chainId = defaults.chainId;\n        }\n        this.serviceAddress = (options.service || defaults.service).trim().replace(/\\/$/, '');\n        this.transport = options.transport;\n        if (options.storage !== null) {\n            this.storage = options.storage || this.transport.storage;\n        }\n        this.requestOptions = {\n            abiProvider: this,\n            textDecoder: options.textDecoder || new TextDecoder(),\n            textEncoder: options.textEncoder || new TextEncoder(),\n            zlib,\n        };\n    }\n    /**\n     * Fetch the ABI for given account, cached.\n     * @internal\n     */\n    async getAbi(account) {\n        let rv = this.abiCache.get(account);\n        if (!rv) {\n            let getAbi = this.pendingAbis.get(account);\n            if (!getAbi) {\n                getAbi = this.rpc.get_abi(account);\n                this.pendingAbis.set(account, getAbi);\n            }\n            rv = (await getAbi).abi;\n            this.pendingAbis.delete(account);\n            if (rv) {\n                this.abiCache.set(account, rv);\n            }\n        }\n        return rv;\n    }\n    /**\n     * Create a new unique buoy callback url.\n     * @internal\n     */\n    createCallbackUrl() {\n        return `${this.serviceAddress}/${uuid()}`;\n    }\n    /**\n     * Create a SigningRequest instance configured for this link.\n     * @internal\n     */\n    async createRequest(args, transport) {\n        // generate unique callback url\n        let request = await esr.SigningRequest.create({\n            ...args,\n            chainId: this.chainId,\n            broadcast: false,\n            callback: {\n                url: this.createCallbackUrl(),\n                background: true,\n            },\n        }, this.requestOptions);\n        const t = transport || this.transport;\n        if (t.prepare) {\n            request = await t.prepare(request);\n        }\n        return request;\n    }\n    /**\n     * Send a SigningRequest instance using this link.\n     * @internal\n     */\n    async sendRequest(request, transport, broadcast = false) {\n        const t = transport || this.transport;\n        try {\n            const linkUrl = request.data.callback;\n            if (!linkUrl.startsWith(this.serviceAddress)) {\n                throw new Error('Request must have a link callback');\n            }\n            if (request.data.flags !== 2) {\n                throw new Error('Invalid request flags');\n            }\n            // wait for callback or user cancel\n            const ctx = {};\n            const socket = waitForCallback(linkUrl, ctx);\n            const cancel = new Promise((resolve, reject) => {\n                t.onRequest(request, (reason) => {\n                    if (ctx.cancel) {\n                        ctx.cancel();\n                    }\n                    if (typeof reason === 'string') {\n                        reject(new CancelError(reason));\n                    }\n                    else {\n                        reject(reason);\n                    }\n                });\n            });\n            const payload = await Promise.race([socket, cancel]);\n            const signer = {\n                actor: payload.sa,\n                permission: payload.sp,\n            };\n            const signatures = Object.keys(payload)\n                .filter((key) => key.startsWith('sig') && key !== 'sig0')\n                .map((key) => payload[key]);\n            // recreate transaction from request response\n            const resolved = await esr.ResolvedSigningRequest.fromPayload(payload, this.requestOptions);\n            const info = resolved.request.getInfo();\n            if (info['fuel_sig']) {\n                signatures.unshift(info['fuel_sig']);\n            }\n            const { serializedTransaction, transaction } = resolved;\n            const result = {\n                request: resolved.request,\n                serializedTransaction,\n                transaction,\n                signatures,\n                payload,\n                signer,\n            };\n            if (broadcast) {\n                const res = await this.rpc.push_transaction({\n                    signatures: result.signatures,\n                    serializedTransaction: result.serializedTransaction,\n                });\n                result.processed = res.processed;\n            }\n            if (t.onSuccess) {\n                t.onSuccess(request, result);\n            }\n            return result;\n        }\n        catch (error) {\n            if (t.onFailure) {\n                t.onFailure(request, error);\n            }\n            throw error;\n        }\n    }\n    /**\n     * Sign and optionally broadcast a EOSIO transaction, action or actions.\n     *\n     * Example:\n     *\n     * ```ts\n     * let result = await myLink.transact({transaction: myTx})\n     * ```\n     *\n     * @param args The action, actions or transaction to use.\n     * @param options Options for this transact call.\n     * @param transport Transport override, for internal use.\n     */\n    async transact(args, options, transport) {\n        const t = transport || this.transport;\n        const broadcast = options ? options.broadcast !== false : true;\n        // eosjs transact compat: upgrade to transaction if args have any header fields\n        let anyArgs = args;\n        if (args.actions &&\n            (anyArgs.expiration ||\n                anyArgs.ref_block_num ||\n                anyArgs.ref_block_prefix ||\n                anyArgs.max_net_usage_words ||\n                anyArgs.max_cpu_usage_ms ||\n                anyArgs.delay_sec)) {\n            args = {\n                transaction: {\n                    expiration: '1970-01-01T00:00:00',\n                    ref_block_num: 0,\n                    ref_block_prefix: 0,\n                    max_net_usage_words: 0,\n                    max_cpu_usage_ms: 0,\n                    delay_sec: 0,\n                    ...anyArgs,\n                },\n            };\n        }\n        const request = await this.createRequest(args, t);\n        const result = await this.sendRequest(request, t, broadcast);\n        return result;\n    }\n    /**\n     * Send an identity request and verify the identity proof.\n     * @param requestPermission Optional request permission if the request is for a specific account or permission.\n     * @param info Metadata to add to the request.\n     * @note This is for advanced use-cases, you probably want to use [[Link.login]] instead.\n     */\n    async identify(requestPermission, info) {\n        const request = await this.createRequest({\n            identity: { permission: requestPermission || null },\n            info,\n        });\n        const res = await this.sendRequest(request);\n        if (!res.request.isIdentity()) {\n            throw new IdentityError(`Unexpected response`);\n        }\n        const message = Buffer.concat([\n            Buffer.from(request.getChainId(), 'hex'),\n            Buffer.from(res.serializedTransaction),\n            Buffer.alloc(32),\n        ]);\n        const { signer } = res;\n        const signerKey = ecc.recover(res.signatures[0], message);\n        const account = await this.rpc.get_account(signer.actor);\n        if (!account) {\n            throw new IdentityError(`Signature from unknown account: ${signer.actor}`);\n        }\n        const permission = account.permissions.find(({ perm_name }) => perm_name === signer.permission);\n        if (!permission) {\n            throw new IdentityError(`${signer.actor} signed for unknown permission: ${signer.permission}`);\n        }\n        const auth = permission.required_auth;\n        const keyAuth = auth.keys.find(({ key }) => publicKeyEqual(key, signerKey));\n        if (!keyAuth) {\n            throw new IdentityError(`${formatAuth(signer)} has no key matching id signature`);\n        }\n        if (auth.threshold > keyAuth.weight) {\n            throw new IdentityError(`${formatAuth(signer)} signature does not reach auth threshold`);\n        }\n        if (requestPermission) {\n            if ((requestPermission.actor !== esr.PlaceholderName &&\n                requestPermission.actor !== signer.actor) ||\n                (requestPermission.permission !== esr.PlaceholderPermission &&\n                    requestPermission.permission !== signer.permission)) {\n                throw new IdentityError(`Unexpected identity proof from ${formatAuth(signer)}, expected ${formatAuth(requestPermission)} `);\n            }\n        }\n        return {\n            ...res,\n            account,\n            signerKey,\n        };\n    }\n    /**\n     * Login and create a persistent session.\n     * @param identifier The session identifier, an EOSIO name (`[a-z1-5]{1,12}`).\n     *                   Should be set to the contract account if applicable.\n     */\n    async login(identifier) {\n        const privateKey = await generatePrivateKey();\n        const requestKey = ecc.privateToPublic(privateKey);\n        const createInfo = {\n            session_name: identifier,\n            request_key: requestKey,\n        };\n        const res = await this.identify(undefined, {\n            link: abiEncode(createInfo, 'link_create'),\n        });\n        const metadata = { sameDevice: res.request.getRawInfo()['return_path'] !== undefined };\n        let session;\n        if (res.payload.link_ch && res.payload.link_key && res.payload.link_name) {\n            session = new LinkChannelSession(this, {\n                identifier,\n                auth: res.signer,\n                publicKey: res.signerKey,\n                channel: {\n                    url: res.payload.link_ch,\n                    key: res.payload.link_key,\n                    name: res.payload.link_name,\n                },\n                requestKey: privateKey,\n            }, metadata);\n        }\n        else {\n            session = new LinkFallbackSession(this, {\n                identifier,\n                auth: res.signer,\n                publicKey: res.signerKey,\n            }, metadata);\n        }\n        if (this.storage) {\n            await this.storeSession(identifier, session);\n        }\n        return {\n            ...res,\n            session,\n        };\n    }\n    /**\n     * Restore previous session, see [[Link.login]] to create a new session.\n     * @param identifier The session identifier, should be same as what was used when creating the session with [[Link.login]].\n     * @param auth A specific session auth to restore, if omitted the most recently used session will be restored.\n     * @returns A [[LinkSession]] instance or null if no session can be found.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error retrieving the session data.\n     **/\n    async restoreSession(identifier, auth) {\n        if (!this.storage) {\n            throw new Error('Unable to restore session: No storage adapter configured');\n        }\n        let key;\n        if (auth) {\n            key = this.sessionKey(identifier, formatAuth(auth));\n        }\n        else {\n            let latest = (await this.listSessions(identifier))[0];\n            if (!latest) {\n                return null;\n            }\n            key = this.sessionKey(identifier, formatAuth(latest));\n        }\n        let data = await this.storage.read(key);\n        if (!data) {\n            return null;\n        }\n        let sessionData;\n        try {\n            sessionData = JSON.parse(data);\n        }\n        catch (error) {\n            throw new Error(`Unable to restore session: Stored JSON invalid (${error.message || String(error)})`);\n        }\n        const session = LinkSession.restore(this, sessionData);\n        if (auth) {\n            // update latest used\n            await this.touchSession(identifier, auth);\n        }\n        return session;\n    }\n    /**\n     * List stored session auths for given identifier.\n     * The most recently used session is at the top (index 0).\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error retrieving the session list.\n     **/\n    async listSessions(identifier) {\n        if (!this.storage) {\n            throw new Error('Unable to list sessions: No storage adapter configured');\n        }\n        let key = this.sessionKey(identifier, 'list');\n        let list;\n        try {\n            list = JSON.parse((await this.storage.read(key)) || '[]');\n        }\n        catch (error) {\n            throw new Error(`Unable to list sessions: Stored JSON invalid (${error.message || String(error)})`);\n        }\n        return list;\n    }\n    /**\n     * Remove stored session for given identifier and auth.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error removing the session data.\n     */\n    async removeSession(identifier, auth) {\n        if (!this.storage) {\n            throw new Error('Unable to remove session: No storage adapter configured');\n        }\n        let key = this.sessionKey(identifier, formatAuth(auth));\n        await this.storage.remove(key);\n        await this.touchSession(identifier, auth, true);\n    }\n    /**\n     * Remove all stored sessions for given identifier.\n     * @throws If no [[LinkStorage]] adapter is configured or there was an error removing the session data.\n     */\n    async clearSessions(identifier) {\n        if (!this.storage) {\n            throw new Error('Unable to clear sessions: No storage adapter configured');\n        }\n        for (const auth of await this.listSessions(identifier)) {\n            await this.removeSession(identifier, auth);\n        }\n    }\n    /**\n     * Create an eosjs compatible signature provider using this link.\n     * @param availableKeys Keys the created provider will claim to be able to sign for.\n     * @param transport (internal) Transport override for this call.\n     * @note We don't know what keys are available so those have to be provided,\n     *       to avoid this use [[LinkSession.makeSignatureProvider]] instead. Sessions can be created with [[Link.login]].\n     */\n    makeSignatureProvider(availableKeys, transport) {\n        return {\n            getAvailableKeys: async () => availableKeys,\n            sign: async (args) => {\n                const request = esr.SigningRequest.fromTransaction(args.chainId, args.serializedTransaction, this.requestOptions);\n                request.setCallback(this.createCallbackUrl(), true);\n                request.setBroadcast(false);\n                const { signatures } = await this.sendRequest(request, transport);\n                return {\n                    ...args,\n                    signatures,\n                };\n            },\n        };\n    }\n    /**\n     * Create an eosjs authority provider using this link.\n     * @note Uses the configured RPC Node's `/v1/chain/get_required_keys` API to resolve keys.\n     */\n    makeAuthorityProvider() {\n        const { rpc } = this;\n        return {\n            async getRequiredKeys(args) {\n                const { availableKeys, transaction } = args;\n                const result = await rpc.fetch('/v1/chain/get_required_keys', {\n                    transaction,\n                    available_keys: availableKeys.map(normalizePublicKey),\n                });\n                return result.required_keys.map(normalizePublicKey);\n            },\n        };\n    }\n    /** Makes sure session is in storage list of sessions and moves it to top (most recently used). */\n    async touchSession(identifier, auth, remove = false) {\n        let auths = await this.listSessions(identifier);\n        let formattedAuth = formatAuth(auth);\n        let existing = auths.findIndex((a) => formatAuth(a) === formattedAuth);\n        if (existing >= 0) {\n            auths.splice(existing, 1);\n        }\n        if (remove === false) {\n            auths.unshift(auth);\n        }\n        let key = this.sessionKey(identifier, 'list');\n        await this.storage.write(key, JSON.stringify(auths));\n    }\n    /** Makes sure session is in storage list of sessions and moves it to top (most recently used). */\n    async storeSession(identifier, session) {\n        let key = this.sessionKey(identifier, formatAuth(session.auth));\n        let data = JSON.stringify(session.serialize());\n        await this.storage.write(key, data);\n        await this.touchSession(identifier, session.auth);\n    }\n    /** Session storage key for identifier and suffix. */\n    sessionKey(identifier, suffix) {\n        return [this.chainId, identifier, suffix].join('-');\n    }\n}\n/**\n * Connect to a WebSocket channel and wait for a message.\n * @internal\n */\nfunction waitForCallback(url, ctx) {\n    return new Promise((resolve, reject) => {\n        let active = true;\n        let retries = 0;\n        const socketUrl = url.replace(/^http/, 'ws');\n        const handleResponse = (response) => {\n            try {\n                resolve(JSON.parse(response));\n            }\n            catch (error) {\n                error.message = 'Unable to parse callback JSON: ' + error.message;\n                reject(error);\n            }\n        };\n        const connect = () => {\n            const socket = new WebSocket(socketUrl);\n            ctx.cancel = () => {\n                active = false;\n                if (socket.readyState === WebSocket.OPEN ||\n                    socket.readyState === WebSocket.CONNECTING) {\n                    socket.close();\n                }\n            };\n            socket.onmessage = (event) => {\n                active = false;\n                if (socket.readyState === WebSocket.OPEN) {\n                    socket.close();\n                }\n                if (typeof Blob !== 'undefined' && event.data instanceof Blob) {\n                    const reader = new FileReader();\n                    reader.onload = () => {\n                        handleResponse(reader.result);\n                    };\n                    reader.onerror = (error) => {\n                        reject(error);\n                    };\n                    reader.readAsText(event.data);\n                }\n                else {\n                    if (typeof event.data === 'string') {\n                        handleResponse(event.data);\n                    }\n                    else {\n                        handleResponse(event.data.toString());\n                    }\n                }\n            };\n            socket.onopen = () => {\n                retries = 0;\n            };\n            socket.onerror = (error) => { };\n            socket.onclose = (close) => {\n                if (active) {\n                    setTimeout(connect, backoff(retries++));\n                }\n            };\n        };\n        connect();\n    });\n}\n/**\n * Exponential backoff function that caps off at 10s after 10 tries.\n * https://i.imgur.com/IrUDcJp.png\n * @internal\n */\nfunction backoff(tries) {\n    return Math.min(Math.pow(tries * 10, 2), 10 * 1000);\n}\n/**\n * Format a EOSIO permission level in the format `actor@permission` taking placeholders into consideration.\n * @internal\n */\nfunction formatAuth(auth) {\n    let { actor, permission } = auth;\n    if (actor === esr.PlaceholderName) {\n        actor = '<any>';\n    }\n    if (permission === esr.PlaceholderName || permission === esr.PlaceholderPermission) {\n        permission = '<any>';\n    }\n    return `${actor}@${permission}`;\n}\n//# sourceMappingURL=link.js.map","/** @internal */\nexport const defaults = {\n    chainId: 'aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906',\n    rpc: 'https://eos.greymass.com',\n    service: 'https://cb.anchor.link',\n};\n//# sourceMappingURL=link-options.js.map","module.exports = __webpack_public_path__ + \"static/media/jungle.3f2409df.png\";","export default {\n    version: 'eosio::abi/1.1',\n    types: [],\n    structs: [\n        {\n            name: 'sealed_message',\n            base: '',\n            fields: [\n                {\n                    name: 'from',\n                    type: 'public_key',\n                },\n                {\n                    name: 'nonce',\n                    type: 'uint64',\n                },\n                {\n                    name: 'ciphertext',\n                    type: 'bytes',\n                },\n                {\n                    name: 'checksum',\n                    type: 'uint32',\n                },\n            ],\n        },\n        {\n            name: 'link_create',\n            base: '',\n            fields: [\n                {\n                    name: 'session_name',\n                    type: 'name',\n                },\n                {\n                    name: 'request_key',\n                    type: 'public_key',\n                },\n            ],\n        },\n        {\n            name: 'link_info',\n            base: '',\n            fields: [\n                {\n                    name: 'expiration',\n                    type: 'time_point_sec',\n                },\n            ],\n        },\n    ],\n    actions: [],\n    ricardian_clauses: [],\n    error_messages: [],\n    tables: [],\n    abi_extensions: [],\n};\n//# sourceMappingURL=link-abi-data.js.map","module.exports = __webpack_public_path__ + \"static/media/eos.b3392955.png\";","module.exports = __webpack_public_path__ + \"static/media/fio.9ae02e71.svg\";","module.exports = __webpack_public_path__ + \"static/media/proton.c090f672.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/wax.f02a31b4.png\";","/**\n * Error that is thrown if a [[LinkTransport]] cancels a request.\n * @internal\n */\nexport class CancelError extends Error {\n    constructor(reason) {\n        super(`User canceled request ${reason ? '(' + reason + ')' : ''}`);\n        this.code = 'E_CANCEL';\n    }\n}\n/**\n * Error that is thrown if an identity request fails to verify.\n * @internal\n */\nexport class IdentityError extends Error {\n    constructor(reason) {\n        super(`Unable to verify identity ${reason ? '(' + reason + ')' : ''}`);\n        this.code = 'E_IDENTITY';\n    }\n}\n/**\n * Error originating from a [[LinkSession]].\n * @internal\n */\nexport class SessionError extends Error {\n    constructor(reason, code) {\n        super(reason);\n        this.code = code;\n    }\n}\n//# sourceMappingURL=errors.js.map","import { Numeric, Serialize } from 'eosjs';\nimport * as ecc from 'eosjs-ecc';\nimport makeFetch from 'fetch-ponyfill';\nimport linkAbi from './link-abi-data';\n/** @internal */\nexport const fetch = makeFetch().fetch;\n/** @internal */\nconst types = Serialize.getTypesFromAbi(Serialize.createInitialTypes(), linkAbi);\n/**\n * Helper to ABI encode value.\n * @internal\n */\nexport function abiEncode(value, typeName) {\n    let type = types.get(typeName);\n    if (!type) {\n        throw new Error(`No such type: ${typeName}`);\n    }\n    let buf = new Serialize.SerialBuffer();\n    type.serialize(buf, value);\n    return buf.asUint8Array();\n}\n/**\n * Helper to ABI decode data.\n * @internal\n */\nexport function abiDecode(data, typeName) {\n    let type = types.get(typeName);\n    if (!type) {\n        throw new Error(`No such type: ${typeName}`);\n    }\n    if (typeof data === 'string') {\n        data = Serialize.hexToUint8Array(data);\n    }\n    else if (!(data instanceof Uint8Array)) {\n        data = new Uint8Array(data);\n    }\n    let buf = new Serialize.SerialBuffer({\n        array: data,\n    });\n    return type.deserialize(buf);\n}\n/**\n * Encrypt a message using AES and shared secret derived from given keys.\n * @internal\n */\nexport function sealMessage(message, privateKey, publicKey) {\n    const res = ecc.Aes.encrypt(privateKey, publicKey, message);\n    const data = {\n        from: ecc.privateToPublic(privateKey),\n        nonce: res.nonce.toString(),\n        ciphertext: res.message,\n        checksum: res.checksum,\n    };\n    return abiEncode(data, 'sealed_message');\n}\n/**\n * Ensure public key is in new PUB_ format.\n * @internal\n */\nexport function normalizePublicKey(key) {\n    if (key.startsWith('PUB_')) {\n        return key;\n    }\n    return Numeric.publicKeyToString(Numeric.stringToPublicKey('EOS' + key.substr(-50)));\n}\n/**\n * Return true if given public keys are equal.\n * @internal\n */\nexport function publicKeyEqual(keyA, keyB) {\n    return normalizePublicKey(keyA) === normalizePublicKey(keyB);\n}\n/**\n * Generate a random private key.\n * Uses browser crypto if available, otherwise falls back to slow eosjs-ecc.\n * @internal\n */\nexport async function generatePrivateKey() {\n    if (typeof window !== 'undefined' && window.crypto) {\n        const data = new Uint32Array(32);\n        window.crypto.getRandomValues(data);\n        return ecc.PrivateKey.fromBuffer(Buffer.from(data)).toString();\n    }\n    else {\n        return await ecc.randomKey();\n    }\n}\n//# sourceMappingURL=utils.js.map","import * as qrcode from 'qrcode';\nimport styleText from './styles';\nimport { fuel } from './fuel';\nclass Storage {\n    constructor(keyPrefix) {\n        this.keyPrefix = keyPrefix;\n    }\n    async write(key, data) {\n        localStorage.setItem(this.storageKey(key), data);\n    }\n    async read(key) {\n        return localStorage.getItem(this.storageKey(key));\n    }\n    async remove(key) {\n        localStorage.removeItem(this.storageKey(key));\n    }\n    storageKey(key) {\n        return `${this.keyPrefix}-${key}`;\n    }\n}\nexport default class BrowserTransport {\n    constructor(options = {}) {\n        this.options = options;\n        this.classPrefix = options.classPrefix || 'anchor-link';\n        this.injectStyles = !(options.injectStyles === false);\n        this.requestStatus = !(options.requestStatus === false);\n        this.fuelEnabled = options.enableGreymassFuel === true;\n        this.storage = new Storage(options.storagePrefix || 'anchor-link');\n    }\n    setupElements() {\n        if (this.injectStyles && !this.styleEl) {\n            this.styleEl = document.createElement('style');\n            this.styleEl.type = 'text/css';\n            const css = styleText.replace(/%prefix%/g, this.classPrefix);\n            this.styleEl.appendChild(document.createTextNode(css));\n            document.head.appendChild(this.styleEl);\n        }\n        if (!this.containerEl) {\n            this.containerEl = this.createEl();\n            this.containerEl.className = this.classPrefix;\n            this.containerEl.onclick = (event) => {\n                if (event.target === this.containerEl) {\n                    event.stopPropagation();\n                    this.hide();\n                    if (this.activeCancel) {\n                        this.activeRequest = undefined;\n                        this.activeCancel('Modal closed');\n                        this.activeCancel = undefined;\n                    }\n                }\n            };\n            document.body.appendChild(this.containerEl);\n        }\n        if (!this.requestEl) {\n            let wrapper = this.createEl({ class: 'inner' });\n            this.requestEl = this.createEl({ class: 'request' });\n            wrapper.appendChild(this.requestEl);\n            this.containerEl.appendChild(wrapper);\n        }\n    }\n    createEl(attrs) {\n        if (!attrs)\n            attrs = {};\n        const el = document.createElement(attrs.tag || 'div');\n        if (attrs) {\n            for (const attr of Object.keys(attrs)) {\n                const value = attrs[attr];\n                switch (attr) {\n                    case 'tag':\n                        break;\n                    case 'text':\n                        el.appendChild(document.createTextNode(value));\n                        break;\n                    case 'class':\n                        el.className = `${this.classPrefix}-${value}`;\n                        break;\n                    default:\n                        el.setAttribute(attr, value);\n                }\n            }\n        }\n        return el;\n    }\n    hide() {\n        if (this.containerEl) {\n            this.containerEl.classList.remove(`${this.classPrefix}-active`);\n        }\n        this.clearTimers();\n    }\n    show() {\n        if (this.containerEl) {\n            this.containerEl.classList.add(`${this.classPrefix}-active`);\n        }\n    }\n    async displayRequest(request) {\n        this.setupElements();\n        let sameDeviceRequest = request.clone();\n        sameDeviceRequest.setInfoKey('same_device', true);\n        sameDeviceRequest.setInfoKey('return_path', returnUrl());\n        let sameDeviceUri = sameDeviceRequest.encode(true, false);\n        let crossDeviceUri = request.encode(true, false);\n        const isIdentity = request.isIdentity();\n        const title = isIdentity ? 'Login' : 'Sign';\n        const subtitle = 'Scan the QR-code with your Anchor app.';\n        const qrEl = this.createEl({ class: 'qr' });\n        qrEl.innerHTML = await qrcode.toString(crossDeviceUri, {\n            margin: 0,\n            errorCorrectionLevel: 'L',\n        });\n        const linkEl = this.createEl({ class: 'uri' });\n        const linkA = this.createEl({\n            tag: 'a',\n            href: crossDeviceUri,\n            text: 'Open Anchor app',\n        });\n        linkA.addEventListener('click', (event) => {\n            event.preventDefault();\n            window.location.href = sameDeviceUri;\n        });\n        linkEl.appendChild(linkA);\n        const infoEl = this.createEl({ class: 'info' });\n        const infoTitle = this.createEl({ class: 'title', tag: 'span', text: title });\n        const infoSubtitle = this.createEl({ class: 'subtitle', tag: 'span', text: subtitle });\n        infoEl.appendChild(infoTitle);\n        infoEl.appendChild(infoSubtitle);\n        const actionEl = this.createEl({ class: 'actions' });\n        actionEl.appendChild(qrEl);\n        actionEl.appendChild(linkEl);\n        emptyElement(this.requestEl);\n        const logoEl = this.createEl({ class: 'logo' });\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.requestEl.appendChild(actionEl);\n        this.show();\n    }\n    onRequest(request, cancel) {\n        this.activeRequest = request;\n        this.activeCancel = cancel;\n        this.displayRequest(request).catch(cancel);\n    }\n    onSessionRequest(session, request, cancel) {\n        if (session.metadata.sameDevice) {\n            request.setInfoKey('return_path', returnUrl());\n        }\n        if (session.type === 'fallback') {\n            this.onRequest(request, cancel);\n            if (session.metadata.sameDevice) {\n                // trigger directly on a fallback same-device session\n                window.location.href = request.encode();\n            }\n            return;\n        }\n        this.activeRequest = request;\n        this.activeCancel = cancel;\n        this.setupElements();\n        const timeout = session.metadata.timeout || 60 * 1000 * 2;\n        const deviceName = session.metadata.name;\n        const start = Date.now();\n        const infoTitle = this.createEl({ class: 'title', tag: 'span', text: 'Sign' });\n        const updateCountdown = () => {\n            const timeLeft = timeout + start - Date.now();\n            const timeFormatted = timeLeft > 0 ? new Date(timeLeft).toISOString().substr(14, 5) : '00:00';\n            infoTitle.textContent = `Sign - ${timeFormatted}`;\n        };\n        this.countdownTimer = setInterval(updateCountdown, 500);\n        updateCountdown();\n        const infoEl = this.createEl({ class: 'info' });\n        infoEl.appendChild(infoTitle);\n        let subtitle;\n        if (deviceName && deviceName.length > 0) {\n            subtitle = `Please open Anchor app on ${deviceName} to review and sign the transaction.`;\n        }\n        else {\n            subtitle = 'Please review and sign the transaction in the linked wallet.';\n        }\n        const infoSubtitle = this.createEl({ class: 'subtitle', tag: 'span', text: subtitle });\n        infoEl.appendChild(infoSubtitle);\n        emptyElement(this.requestEl);\n        const logoEl = this.createEl({ class: 'logo' });\n        this.requestEl.appendChild(logoEl);\n        this.requestEl.appendChild(infoEl);\n        this.show();\n        if (isAppleHandheld() && session.metadata.sameDevice) {\n            window.location.href = 'anchor://link';\n        }\n    }\n    clearTimers() {\n        if (this.closeTimer) {\n            clearTimeout(this.closeTimer);\n            this.closeTimer = undefined;\n        }\n        if (this.countdownTimer) {\n            clearTimeout(this.countdownTimer);\n            this.countdownTimer = undefined;\n        }\n    }\n    async prepare(request, session) {\n        if (!this.fuelEnabled || !session || request.isIdentity()) {\n            // don't attempt to cosign id request or if we don't have a session attached\n            return request;\n        }\n        try {\n            return await fuel(request, session);\n        }\n        catch (error) {\n            console.info(`Not applying fuel (${error.message})`);\n        }\n        return request;\n    }\n    onSuccess(request) {\n        if (request === this.activeRequest) {\n            this.clearTimers();\n            if (this.requestStatus) {\n                this.setupElements();\n                const infoEl = this.createEl({ class: 'info' });\n                const logoEl = this.createEl({ class: 'logo' });\n                logoEl.classList.add('success');\n                const infoTitle = this.createEl({ class: 'title', tag: 'span', text: 'Success!' });\n                const subtitle = request.isIdentity() ? 'Identity signed.' : 'Transaction signed.';\n                const infoSubtitle = this.createEl({ class: 'subtitle', tag: 'span', text: subtitle });\n                infoEl.appendChild(infoTitle);\n                infoEl.appendChild(infoSubtitle);\n                emptyElement(this.requestEl);\n                this.requestEl.appendChild(logoEl);\n                this.requestEl.appendChild(infoEl);\n                this.show();\n                this.closeTimer = setTimeout(() => {\n                    this.hide();\n                }, 1.5 * 1000);\n            }\n            else {\n                this.hide();\n            }\n        }\n    }\n    onFailure(request, error) {\n        if (request === this.activeRequest) {\n            this.clearTimers();\n            if (this.requestStatus) {\n                this.setupElements();\n                const infoEl = this.createEl({ class: 'info' });\n                const logoEl = this.createEl({ class: 'logo' });\n                logoEl.classList.add('error');\n                const infoTitle = this.createEl({\n                    class: 'title',\n                    tag: 'span',\n                    text: 'Transaction error',\n                });\n                const infoSubtitle = this.createEl({\n                    class: 'subtitle',\n                    tag: 'span',\n                    text: error.message || String(error),\n                });\n                infoEl.appendChild(infoTitle);\n                infoEl.appendChild(infoSubtitle);\n                emptyElement(this.requestEl);\n                this.requestEl.appendChild(logoEl);\n                this.requestEl.appendChild(infoEl);\n                this.show();\n                this.closeTimer = setTimeout(() => {\n                    this.hide();\n                }, 5 * 1000);\n            }\n            else {\n                this.hide();\n            }\n        }\n    }\n}\nfunction emptyElement(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\nconst returnUrlAlphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\nconst returnUrlAlphabetLen = returnUrlAlphabet.length;\n/** Generate a return url with a random #fragment so mobile safari will redirect back w/o reload. */\nfunction returnUrl() {\n    let rv = window.location.href.split('#')[0] + '#';\n    for (let i = 0; i < 8; i++) {\n        rv += returnUrlAlphabet.charAt(Math.floor(Math.random() * returnUrlAlphabetLen));\n    }\n    return rv;\n}\nfunction isAppleHandheld() {\n    return /iP(ad|od|hone)/i.test(navigator.userAgent);\n}\n//# sourceMappingURL=index.js.map","const supportedChains = {\n    '2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840': 'https://jungle3.greymass.com',\n};\nasync function apiCall(url, body) {\n    return (await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: body ? JSON.stringify(body) : undefined,\n    })).json();\n}\nexport async function fuel(request, session) {\n    const chainId = request.getChainId();\n    const nodeUrl = supportedChains[chainId];\n    if (!nodeUrl) {\n        throw new Error('Chain does not support Fuel.');\n    }\n    const result = await apiCall(nodeUrl + '/v1/cosigner/sign', {\n        request: request,\n        signer: session.auth,\n    });\n    if (result.data.signatures[0]) {\n        request.setInfoKey('fuel_sig', result.data.signatures[0]);\n    }\n    else {\n        throw new Error('No signature returned from Fuel');\n    }\n    // ok to mutate request here, prependAction took a copy\n    request.data.req = result.data.request;\n    return request;\n}\n//# sourceMappingURL=fuel.js.map","export default `\n/* Anchor Link */\n\n.%prefix% * {\n    box-sizing: border-box;\n    line-height: 1;\n}\n\n.%prefix% {\n    font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue',\n        Arial, sans-serif;\n    font-size: 13px;\n    background: rgba(0, 0, 0, 0.6);\n    position: fixed;\n    top: 0px;\n    left: 0px;\n    width: 100%;\n    height: 100%;\n    z-index: 2147483647;\n    display: none;\n    align-items: center;\n    justify-content: center;\n}\n\n.%prefix%-active {\n    display: flex;\n}\n\n.%prefix%-inner {\n    background: #F1F1F1;\n    margin: 1em;\n    padding-top: 3.5em;\n    border-radius: 1.5em;\n    box-shadow: 0px 4px 100px rgba(0, 0, 0, .5);\n    width: 24em;\n}\n\n.%prefix%-logo {\n    width: 5em;\n    height: 5em;\n    margin: 0 auto;\n    margin-top: -3.75em;;\n    background-image: url(\"data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg viewBox='0 0 160 160' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='80' cy='80' r='80' fill='%233650A2'/%3E%3Cpath d='m80.006 30c2.2988 0 4.3956 1.3134 5.3987 3.3818l24.006 49.5 0.542 1.1178h-13.337l-3.8797-8h-25.461l-3.8798 8h-13.337l0.5423-1.1182 24.006-49.5c1.0031-2.0684 3.0998-3.3818 5.3986-3.3818zm-7.8807 36h15.761l-7.8807-16.25-7.8807 16.25zm25.874 35h12.006c-0.361 16.152-13.731 29-29.999 29s-29.638-12.848-29.998-29h12.005c0.281 7.354 5.1673 13.631 11.987 15.996v-23.996c0-3.3137 2.6863-6 6-6s6 2.6863 6 6v24c6.8262-2.362 11.718-8.641 11.999-16z' clip-rule='evenodd' fill='%23fff' fill-rule='evenodd'/%3E%3C/svg%3E%0A\");\n}\n\n.%prefix%-logo.error {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%23FC3D39'/%3E%3Cpath fill='%23fff' d='M22.3 48h25.4c2.5 0 4-1.7 4-4a4 4 0 00-.5-2L38.5 19.3a4 4 0 00-3.5-2 4 4 0 00-3.5 2L18.8 42.1c-.3.6-.5 1.3-.5 2 0 2.2 1.6 4 4 4zM35 37c-.9 0-1.4-.6-1.4-1.5l-.2-7.7c0-.9.6-1.6 1.6-1.6s1.7.7 1.7 1.6l-.3 7.7c0 1-.5 1.5-1.4 1.5zm0 6c-1 0-1.9-.8-1.9-1.8s.9-1.8 2-1.8c1 0 1.8.7 1.8 1.8 0 1-.9 1.8-1.9 1.8z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-logo.success {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 70 70'%3E%3Cdefs/%3E%3Ccircle cx='35' cy='35' r='35' fill='%233DC55D'/%3E%3Cpath fill='%23fff' d='M30.9 49.7a2 2 0 001.8-1L48 24.9c.3-.5.4-1 .4-1.4 0-1-.7-1.7-1.7-1.7-.8 0-1.2.3-1.6 1L30.8 45.4 23.5 36c-.5-.6-1-.9-1.6-.9-1 0-1.8.8-1.8 1.8 0 .4.2.9.6 1.3L29 48.7c.6.7 1.1 1 1.9 1z'/%3E%3C/svg%3E\");\n}\n\n.%prefix%-request {\n    padding: 1.5em;\n    border-radius: 1.5em;\n    border-top-left-radius: 0;\n    border-top-right-radius: 0;\n    background: white;\n}\n\n.%prefix%-info {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    line-height: 2em;\n}\n\n.%prefix%-title {\n    color: #5C5C5C;\n    font-size: 1.8em;\n    margin-top: 0.5em;\n    font-weight: bold;\n}\n\n.%prefix%-subtitle {\n    margin-top: 1em;\n    color: #5C5C5C;\n    text-align: center;\n    margin-bottom: 0.5em;\n}\n\n.%prefix%-actions {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.%prefix%-uri {\n    width: 100%;\n\n}\n.%prefix%-uri a {\n    color: #007AFF;\n    background: rgba(116, 116, 128, 0.08);\n    text-decoration: none;\n    font-size: 1.3em;\n    flex-grow: 1;\n    flex: 1;\n    width: 100%;\n    padding: 1.5em;\n    border-radius: 0.75em;\n    font-weight: 500;\n    letter-spacing: .01em;\n    text-align: center;\n    display: block;\n    margin-top: 1em;\n}\n\n.%prefix%-qr {\n    margin-top: 1em;\n}\n\n.%prefix%-qr svg {\n    width: 100%;\n}\n`;\n//# sourceMappingURL=styles.js.map","import React, { Component } from 'react'\nimport { Button, Table } from 'semantic-ui-react';\n\nclass Debug extends Component {\n  render() {\n    const { chain, session, sessions } = this.props;\n    return (\n      <Table>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell collapsing>{chain.name}</Table.HeaderCell>\n            <Table.HeaderCell>Account</Table.HeaderCell>\n            <Table.HeaderCell>Permission</Table.HeaderCell>\n            <Table.HeaderCell />\n          </Table.Row>\n        </Table.Header>\n        {(sessions.length)\n          ? (\n            <Table.Body>\n              {sessions.map((s) => {\n                const isCurrent = (session && session.auth && s.actor === session.auth.actor && s.permission === session.auth.permission)\n                const key = Object.values(s).join('-')\n                return (\n                  <Table.Row key={key}>\n                    <Table.Cell collapsing>\n                      <Button\n                        color={isCurrent ? \"blue\" : \"green\"}\n                        content={isCurrent ? \"In Use\" : \"Use Account\"}\n                        disabled={isCurrent}\n                        onClick={() => this.props.setSession(s)}\n                      />\n                    </Table.Cell>\n                    <Table.Cell>{s.actor}</Table.Cell>\n                    <Table.Cell>{s.permission}</Table.Cell>\n                    <Table.Cell collapsing>\n                      <Button\n                        color=\"red\"\n                        icon=\"trash\"\n                        onClick={() => this.props.removeSession(s)}\n                      />\n                    </Table.Cell>\n                  </Table.Row>\n                );\n              })}\n            </Table.Body>\n          )\n          : (\n            <Table.Body>\n              <Table.Row textAlign=\"center\">\n                <Table.Cell colSpan=\"4\">No Accounts Imported</Table.Cell>\n              </Table.Row>\n            </Table.Body>\n          )\n        }\n        <Table.Footer fullWidth>\n          <Table.Row>\n            <Table.HeaderCell />\n            <Table.HeaderCell colSpan=\"4\" textAlign=\"center\">\n              <Button\n                basic\n                content=\"Add Account\"\n                fluid\n                onClick={this.props.addAccount}\n                primary\n              />\n            </Table.HeaderCell>\n          </Table.Row>\n        </Table.Footer>\n      </Table>\n    );\n  }\n}\n\nexport default Debug;\n","import React, { Component } from 'react'\nimport { Dropdown } from 'semantic-ui-react';\n\nimport eosLogo from './assets/eos.png';\nimport fioLogo from './assets/fio.svg';\nimport jungleLogo from './assets/jungle.png';\nimport protonLogo from './assets/proton.png';\nimport telosLogo from './assets/telos.png';\nimport waxLogo from './assets/wax.png';\n\nimport blockchains from './assets/blockchains.json';\n\nconst logoMap = {\n  \"0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72\": eosLogo,\n  \"b20901380af44ef59c5918439a1f9a41d83669020319a80574b804a5f95cbd7e\": fioLogo,\n  \"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473\": jungleLogo,\n  \"2a02a0053e5a8cf73a56ba0fda11e4d92e0238a4a2aa74fccf46d5a910746840\": jungleLogo,\n  \"71ee83bcf52142d61019d95f9cc5427ba6a0d7ff8accd9e2088ae2abeaf3d3dd\": protonLogo,\n  \"1eaa0824707c8c16bd25145493bf062aecddfeb56c736f6ba6397f3195f33c9f\": telosLogo,\n  \"f16b1833c747c43682f4386fca9cbb327929334a762755ebec17f6f23c9b8a12\": waxLogo,\n};\n\nconst options = blockchains.map((chain) => ({\n  key: chain.chainId,\n  text: chain.name,\n  value: chain.chainId,\n  image: {\n    avatar: true,\n    src: logoMap[chain.chainId]\n  },\n}));\n\n\nclass Blockchains extends Component {\n  render() {\n    const { chain } = this.props;\n    return (\n      <Dropdown\n        fluid\n        onChange={this.props.onChange}\n        options={options}\n        placeholder='Select Blockchain...'\n        search\n        selection\n        value={chain.chainId}\n      />\n    );\n  }\n}\n\nexport default Blockchains;\n","import React, { Component } from 'react'\nimport { Header, Segment } from 'semantic-ui-react';\nimport ReactJson from 'react-json-view';\n\nclass SigningError extends Component {\n  render() {\n    const { error } = this.props;\n    console.log(error)\n    return (\n      <Segment color=\"red\" size=\"large\">\n        <Header size=\"large\">\n          Error while processing request\n        </Header>\n        {error.message}\n      </Segment>\n    );\n  }\n}\n\nexport default SigningError;\n","import React, { Component } from 'react'\nimport { Header, List, Segment } from 'semantic-ui-react';\nimport ReactJson from 'react-json-view';\nimport { CodeBlock, monokai } from 'react-code-blocks'\n\nimport { Serialize } from 'eosjs'\nconst transactionAbi = require('eosjs/src/transaction.abi.json')\nconst transactionTypes: Map<string, Serialize.Type> = Serialize.getTypesFromAbi(Serialize.createInitialTypes(), transactionAbi)\n\nclass Transaction extends Component {\n  testResponse = () => {\n    const { response } = this.props\n    const tests = [\n      {\n        name: \"Signatures returned by signer\",\n        desc: \"The signer has returned signatures in its response.\",\n        test: (r) => !!(r.signatures && r.signatures.length >= 1),\n        data: (r) => JSON.stringify(r.signatures),\n      },\n      {\n        name: \"Unserialized transaction returned by signer\",\n        desc: \"The signer has returned an unserialized transaction in its response.\",\n        test: (r) => !!(r.transaction),\n        data: (r) => JSON.stringify(r.transaction),\n      },\n      {\n        name: \"Serialized transaction returned by signer\",\n        desc: \"The signer has returned a serialized transaction in its response.\",\n        test: (r) => !!(r.serializedTransaction),\n        data: (r) => JSON.stringify(r.serializedTransaction),\n      },\n      {\n        name: \"Serialized transaction successfully deserialized\",\n        desc: \"The serialized transaction the signer returned can be successfully deserialized.\",\n        test: (r) => {\n          try {\n            const tx = this.deserialize(r.serializedTransaction)\n            return (\n              tx.expiration\n              && tx.actions\n              && tx.actions.length > 0\n              && tx.ref_block_num > 0\n              && tx.ref_block_prefix > 0\n            )\n          } catch (e) {\n            return false\n          }\n        },\n        data: (r) => {\n          try {\n            const tx = this.deserialize(r.serializedTransaction)\n            return JSON.stringify(tx)\n          } catch (e) {\n            return JSON.stringify({})\n          }\n        }\n      },\n    ]\n    return tests.map((testCase) => {\n      return {\n        ...testCase,\n        res: testCase.test(response),\n        val: testCase.data(response),\n      }\n    })\n  }\n  deserialize = (serialized) => {\n    const buffer = new Serialize.SerialBuffer({\n      array: serialized,\n    })\n    const type = transactionTypes.get('transaction')\n    return type.deserialize(buffer)\n  }\n  render() {\n    const { response } = this.props;\n    const tests = this.testResponse()\n    return (\n      <React.Fragment>\n        <Segment style={{ overflowX: 'scroll' }}>\n          <List divided relaxed>\n            {tests.map(test => (\n              <List.Item>\n                <List.Icon\n                  color={test.res ? \"green\" : \"red\"}\n                  name={test.res ? \"checkmark\" : \"x\"}\n                  size=\"large\"\n                  verticalAlign=\"top\"\n                />\n                <List.Content>\n                  <List.Header>{test.name}</List.Header>\n                  <List.Description>{test.desc}</List.Description>\n                  <List.Content style={{ margin: '0.5em 0' }}><code>{test.val}</code></List.Content>\n                </List.Content>\n              </List.Item>\n            ))}\n          </List>\n        </Segment>\n        <Segment style={{ background: 'rgb(39, 40, 34)' }}>\n          <Header dividing size=\"large\" style={{ borderBottom: '1px solid white', color: 'white' }}>\n            Callback Payload\n          </Header>\n          <CodeBlock\n            text={`console.log(response.payload);`}\n            language={\"javascript\"}\n            showLineNumbers={false}\n            theme={monokai}\n            wrapLines\n          />\n          <ReactJson\n            displayDataTypes={false}\n            displayObjectSize={false}\n            enableClipboard={false}\n            iconStyle=\"square\"\n            name={null}\n            src={response.payload}\n            style={{\n              background: 'rgb(39, 40, 34)',\n              marginTop: '1em',\n              overflow: 'scroll',\n            }}\n            theme=\"harmonic\"\n          />\n        </Segment>\n        <Segment style={{ background: 'rgb(39, 40, 34)' }}>\n          <Header dividing size=\"large\" style={{ borderBottom: '1px solid white', color: 'white' }}>\n            Signer\n          </Header>\n          <CodeBlock\n            text={`console.log(response.signer);`}\n            language={\"javascript\"}\n            showLineNumbers={false}\n            theme={monokai}\n            wrapLines\n          />\n          <ReactJson\n            displayDataTypes={false}\n            displayObjectSize={false}\n            enableClipboard={false}\n            iconStyle=\"square\"\n            name={null}\n            src={response.signer}\n            style={{\n              background: 'rgb(39, 40, 34)',\n              marginTop: '1em',\n              overflow: 'scroll',\n            }}\n            theme=\"harmonic\"\n          />\n        </Segment>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Transaction;\n","// React and UI components for demo\nimport React, { Component } from 'react'\nimport { Button, Container, Header, Segment } from 'semantic-ui-react'\n\n// The required anchor-link includes\nimport AnchorLink from 'anchor-link'\nimport AnchorLinkBrowserTransport from 'anchor-link-browser-transport'\n\n// Optional interfaces to import from anchor-link\nimport { PermissionLevel } from 'anchor-link'\n\n// React components for this demo, not required\nimport { find } from 'lodash'\nimport blockchains from './assets/blockchains.json'\nimport Accounts from './Accounts.js'\nimport Blockchains from './Blockchains.js'\nimport SigningError from './SigningError.js'\nimport Response from './Response.js'\n\nclass App extends Component {\n  // Demo initialization code\n  constructor(props) {\n    super(props)\n    // Add the ability to retrieve the chainId from the URL\n    const search = window.location.search\n    const params = new URLSearchParams(search)\n    const chainId = params.get('chainId') || '0db13ab9b321c37c0ba8481cb4681c2788b622c3abfd1f12f0e5353d44ba6e72'\n    // Set initial blank application state\n    this.state = {\n      error: undefined,\n      response: undefined,\n      session: undefined,\n      sessions: [],\n      chainId,\n    }\n  }\n  componentDidMount() {\n    // Configure anchor-link when this component mounts\n    this.establishLink()\n  }\n  componentDidUpdate(prevProps, prevState) {\n    // If the chainId changes in state, reconfigure anchor-link for that chain\n    if (this.state.chainId !== prevState.chainId) {\n      this.establishLink()\n    }\n  }\n  addAccount = async () => {\n    const { chainId } = this.state\n    try {\n      // Use the anchor-link login method with the chain id to establish a session\n      const identity = await this.link.login('anchor-link-demo-multipass', { chainId })\n      // Retrieve a list of all available sessions to update demo state\n      const sessions = await this.link.listSessions('anchor-link-demo-multipass')\n      // Update state with the current session and all available sessions\n      this.setState({\n        error: undefined,\n        response: undefined,\n        session: identity.session,\n        sessions,\n      })\n    } catch(e) {\n      console.log(e)\n    }\n  }\n  establishLink = async () => {\n    // Load the current chainId from state\n    const { chainId } = this.state\n    // Find the blockchain and retrieve the appropriate API endpoint for the demo\n    const blockchain = find(blockchains, { chainId })\n    const rpc = blockchain.rpcEndpoints[0]\n    // Initialize anchor-link using the local storage persist module\n    this.link = new AnchorLink({\n      // Specify the target chainId\n      chainId,\n      // Set the API to use\n      rpc: `${rpc.protocol}://${rpc.host}:${rpc.port}`,\n      // Optional: Set the callback service, which will default to https://cb.anchor.link\n      service: 'https://cb.anchor.link',\n      // Pass in the browser transport\n      transport: new AnchorLinkBrowserTransport({\n        // Optional: Enable Fuel to cosign transactions and cover resource costs when needed\n        enableGreymassFuel: true,\n        // Optional: Disable the browser transport success/failure messages to serve your own\n        requestStatus: false\n      }),\n    })\n    // Attempt to restore the last used session for this particular chainId\n    const session = await this.link.restoreSession('anchor-link-demo-multipass')\n    // Load all existing sessions for this chain\n    const sessions = await this.link.listSessions('anchor-link-demo-multipass')\n    // Save current chainId and session into application state\n    this.setState({\n      chainId,\n      error: undefined,\n      session,\n      sessions,\n    })\n    // Return in the event we need to immediately use\n    return this.link\n  }\n  signTransaction = async () => {\n    // Retrieve current session from state\n    const { session } = this.state\n    try {\n      // Reset our response state to clear any previous transaction data\n      this.setState({ response: undefined })\n      const action = {\n        account: 'eosio',\n        name: 'voteproducer',\n        authorization: [session.auth],\n        data: {\n          producers: [],\n          // proxy: 'greymassvote',\n          proxy: 'waaaaaaaaaat',\n          voter: session.auth.actor\n        }\n      }\n      // Call transact on the session (compatible with eosjs.transact)\n      const response = await session.transact({\n        actions: [action]\n      }, {\n        // Optional: Prevent anchor-link from broadcasting this transaction (default: True)\n        //\n        //    The wallet/signer connected to this app will NOT broadcast the transaction\n        //    as is defined by the anchor-link protocol. Broadcasting is the responsibility\n        //    of anchor-link running inside an application (like this demo).\n        //\n        //    For this demo specifically we do NOT want the transaction to ever be broadcast\n        //    to the blockchain, so we're disabling it here.\n        //\n        //    For all normal applications using anchor-link, you can omit this.\n        //\n        // broadcast: false,\n      })\n      // Update application state with the responses of the transaction\n      this.setState({\n        error: undefined,\n        response,\n      })\n    } catch(e) {\n      console.log(e)\n      this.setState({ error: e })\n    }\n  }\n  // React State Helper to update chainId while switching blockchains\n  setChainId = (e, { value }) => this.setState({\n    chainId: value,\n    error: undefined,\n    response: undefined,\n  }, () => {\n    const searchParams = new URLSearchParams(window.location.search)\n    searchParams.set('chainId', value)\n    window.history.pushState(null, null, `?${searchParams.toString()}`)\n  })\n  // React State Helper to update sessions while switching accounts\n  setSession = async (auth:PermissionLevel) => {\n    // Restore a specific session based on an auth (e.g. {actor: 'foo', permission: 'bar'})\n    const session = await this.link.restoreSession('anchor-link-demo-multipass', auth)\n    // Update application state with new session and reset response data\n    this.setState({\n      error: undefined,\n      response: undefined,\n      session,\n    })\n  }\n  // React State Helper to remove/delete a session\n  removeSession = async (auth:PermissionLevel) => {\n    // Remove from local storage based on an auth (e.g. {actor: 'foo', permission: 'bar'})\n    await this.link.removeSession('anchor-link-demo-multipass', auth)\n    // Remove from local application state\n    const { session, sessions } = this.state\n    // If this was the currently active account, remove the session\n    if (session && session.auth.actor === auth.actor && session.auth.permission === auth.permission) {\n      this.setState({ session: undefined });\n    }\n    this.setState({\n      sessions: sessions.filter(s => !(s.actor === auth.actor && s.permission === auth.permission))\n    })\n  }\n  render() {\n    // Load state for rendering\n    const {\n      chainId,\n      error,\n      session,\n      sessions,\n      response,\n    } = this.state\n    // Find the blockchain information (rpc, name, etc) for UI purposes\n    const chain = find(blockchains, { chainId })\n    // Return the UI\n    return (\n      <Container\n        style={{ paddingTop: '2em' }}\n      >\n        <Header attached=\"top\" block size=\"huge\">\n          anchor-link-demo-multipass\n          <Header.Subheader>\n            <p>An anchor-link demo that allows multiple persistent logins from different blockchains and accounts.</p>\n            <p>Source code: <a href=\"https://github.com/greymass/anchor-link-demo-multipass\">https://github.com/greymass/anchor-link-demo-multipass</a></p>\n          </Header.Subheader>\n        </Header>\n        <Segment attached padded>\n          <p>Switch to a specific blockchain.</p>\n          <Blockchains\n            chain={chain}\n            onChange={this.setChainId}\n          />\n        </Segment>\n        <Segment attached padded>\n          <Header>Available Accounts</Header>\n          <Accounts\n            addAccount={this.addAccount}\n            chain={chain}\n            session={session}\n            sessions={sessions}\n            setSession={this.setSession}\n            removeSession={this.removeSession}\n          />\n        </Segment>\n        <Segment attached padded>\n          <Header>Transact with anchor-link</Header>\n          <Button\n            content=\"Sign Test Transaction\"\n            disabled={!session}\n            icon=\"external\"\n            onClick={this.signTransaction}\n            primary\n            size=\"huge\"\n          />\n          {(!session)\n            ? <p style={{ marginTop: '0.5em'}}>Login using anchor-link to sign a test transaction.</p>\n            : false\n          }\n        </Segment>\n        <Segment attached=\"bottom\" padded>\n          {(error)\n            ? (\n              <SigningError\n                error={error}\n              />\n            )\n            : false\n          }\n          {(response)\n            ? (\n              <Response\n                response={response}\n              />\n            )\n            : false\n          }\n        </Segment>\n      </Container>\n    )\n  }\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'semantic-ui-css/semantic.min.css'\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { SessionError } from './errors';\nimport { abiEncode, fetch, sealMessage } from './utils';\n/**\n * Type describing a link session that can create a eosjs compatible\n * signature provider and transact for a specific auth.\n */\nexport class LinkSession {\n    /**\n     * Convenience, remove this session from associated [[Link]] storage if set.\n     * Equivalent to:\n     * ```ts\n     * session.link.removeSession(session.identifier, session.auth)\n     * ```\n     */\n    async remove() {\n        if (this.link.storage) {\n            await this.link.removeSession(this.identifier, this.auth);\n        }\n    }\n    /** Restore a previously serialized session. */\n    static restore(link, data) {\n        switch (data.type) {\n            case 'channel':\n                return new LinkChannelSession(link, data.data, data.metadata);\n            case 'fallback':\n                return new LinkFallbackSession(link, data.data, data.metadata);\n            default:\n                throw new Error('Unable to restore, session data invalid');\n        }\n    }\n}\n/**\n * Link session that pushes requests over a channel.\n * @internal\n */\nexport class LinkChannelSession extends LinkSession {\n    constructor(link, data, metadata) {\n        super();\n        this.type = 'channel';\n        this.timeout = 2 * 60 * 1000; // ms\n        this.link = link;\n        this.auth = data.auth;\n        this.publicKey = data.publicKey;\n        this.channel = data.channel;\n        this.identifier = data.identifier;\n        this.encrypt = (request) => {\n            return sealMessage(request.encode(true, false), data.requestKey, data.channel.key);\n        };\n        this.metadata = {\n            ...(metadata || {}),\n            timeout: this.timeout,\n            name: this.channel.name,\n        };\n        this.serialize = () => ({\n            type: 'channel',\n            data,\n            metadata: this.metadata,\n        });\n    }\n    onSuccess(request, result) {\n        if (this.link.transport.onSuccess) {\n            this.link.transport.onSuccess(request, result);\n        }\n    }\n    onFailure(request, error) {\n        if (this.link.transport.onFailure) {\n            this.link.transport.onFailure(request, error);\n        }\n    }\n    onRequest(request, cancel) {\n        const info = {\n            expiration: new Date(Date.now() + this.timeout).toISOString().slice(0, -1),\n        };\n        if (this.link.transport.onSessionRequest) {\n            this.link.transport.onSessionRequest(this, request, cancel);\n        }\n        setTimeout(() => {\n            cancel(new SessionError('Wallet did not respond in time', 'E_TIMEOUT'));\n        }, this.timeout + 500);\n        request.data.info.push({\n            key: 'link',\n            value: abiEncode(info, 'link_info'),\n        });\n        fetch(this.channel.url, {\n            method: 'POST',\n            headers: {\n                'X-Buoy-Wait': (this.timeout / 1000).toFixed(0),\n            },\n            body: this.encrypt(request),\n        })\n            .then((response) => {\n            if (response.status !== 200) {\n                cancel(new SessionError('Unable to push message', 'E_DELIVERY'));\n            }\n            else {\n                // request delivered\n            }\n        })\n            .catch((error) => {\n            cancel(new SessionError(`Unable to reach link service (${error.message || String(error)})`, 'E_DELIVERY'));\n        });\n    }\n    prepare(request) {\n        if (this.link.transport.prepare) {\n            return this.link.transport.prepare(request, this);\n        }\n        return Promise.resolve(request);\n    }\n    makeSignatureProvider() {\n        return this.link.makeSignatureProvider([this.publicKey], this);\n    }\n    makeAuthorityProvider() {\n        return this.link.makeAuthorityProvider();\n    }\n    transact(args, options) {\n        return this.link.transact(args, options, this);\n    }\n}\n/**\n * Link session that sends every request over the transport.\n * @internal\n */\nexport class LinkFallbackSession extends LinkSession {\n    constructor(link, data, metadata) {\n        super();\n        this.type = 'fallback';\n        this.link = link;\n        this.auth = data.auth;\n        this.publicKey = data.publicKey;\n        this.metadata = metadata || {};\n        this.identifier = data.identifier;\n        this.serialize = () => ({\n            type: this.type,\n            data,\n            metadata: this.metadata,\n        });\n    }\n    onSuccess(request, result) {\n        if (this.link.transport.onSuccess) {\n            this.link.transport.onSuccess(request, result);\n        }\n    }\n    onFailure(request, error) {\n        if (this.link.transport.onFailure) {\n            this.link.transport.onFailure(request, error);\n        }\n    }\n    onRequest(request, cancel) {\n        if (this.link.transport.onSessionRequest) {\n            this.link.transport.onSessionRequest(this, request, cancel);\n        }\n        else {\n            this.link.transport.onRequest(request, cancel);\n        }\n    }\n    prepare(request) {\n        if (this.link.transport.prepare) {\n            return this.link.transport.prepare(request, this);\n        }\n        return Promise.resolve(request);\n    }\n    makeSignatureProvider() {\n        return this.link.makeSignatureProvider([this.publicKey], this);\n    }\n    makeAuthorityProvider() {\n        return this.link.makeAuthorityProvider();\n    }\n    transact(args, options) {\n        return this.link.transact(args, options, this);\n    }\n}\n//# sourceMappingURL=link-session.js.map"],"sourceRoot":""}